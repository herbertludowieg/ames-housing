
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Introduction &#8212; ML projects  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'linear-regression/ames-housing-data';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="GUI representation of description file" href="ames-housing-gui.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">ML projects  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ames-housing-gui.html">GUI representation of description file</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Introduction</a></li>




</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/linear-regression/ames-housing-data.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Studying-data">Studying data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Checking-for-any-missing-values-in-the-original-data-set">Checking for any missing values in the original data set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Making-sure-that-there-is-a-description-for-every-available-feature-column">Making sure that there is a description for every available feature column</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Data-Preprocessing">Data Preprocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Outliers">Outliers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Electrical">Electrical</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Masonry-Veneer">Masonry Veneer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Basement">Basement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Garage">Garage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Pool-quality,-Alley,-Fence,-Misc-Feature">Pool quality, Alley, Fence, Misc Feature</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Lot-Frontage">Lot Frontage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Save-the-final-data-set-after-processing">Save the final data set after processing</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Linear-Regression">Linear Regression</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Import-linear-regression-libraries">Import linear regression libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Data-manipulation">Data manipulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Make-a-train-test-split">Make a train test split</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Scale-the-data">Scale the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Ordinary-least-squares">Ordinary least squares</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Plotting-real-vs.-predicted-values">Plotting real vs. predicted values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Ridge-Regression">Ridge Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Mean-Absolute-Error">Mean Absolute Error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Mean-Squared-Error-or-Root-Mean-Squared-Error">Mean Squared Error or Root Mean Squared Error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#R-Squared-(coefficient-of-determination)">R Squared (coefficient of determination)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Median-Absolute-Error">Median Absolute Error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Mean-Absolute-Percentage-Error">Mean Absolute Percentage Error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Analyzing-error-metrics">Analyzing error metrics</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Plotting-error-metrics">Plotting error metrics</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Plotting real vs. predicted values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#LASSO-regression">LASSO regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Plotting real vs. predicted values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Elastic-Net">Elastic Net</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Plotting real vs. predicted values</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Conclusion">Conclusion</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Introduction">
<h1>Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">#</a></h1>
<p>In this notebook I am using the housing data set from Ames, Iowa (can be found on <a class="reference external" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques">Kaggle</a>) where I will be performing:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#Data-Preprocessing"><span class="std std-ref">Data Preprocessing</span></a></p></li>
<li><p><a class="reference internal" href="#Linear-Regression"><span class="std std-ref">Linear Regression Analysis</span></a></p>
<ul class="simple">
<li><p><a class="reference internal" href="#Ordinary-least-squares"><span class="std std-ref">Ordinary Least Squares</span></a></p></li>
<li><p><a class="reference internal" href="#Ridge-Regression"><span class="std std-ref">Ridge Regression</span></a></p></li>
<li><p><a class="reference internal" href="#LASSO-regression"><span class="std std-ref">LASSO Regression</span></a></p></li>
<li><p><a class="reference internal" href="#Elastic-Net"><span class="std std-ref">Elastic Net</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#Conclusion"><span class="std std-ref">Conclusion</span></a></p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">ticker</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">missing_vals</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Get the number and percentage of missing values per column in</span>
<span class="sd">    the given data frame.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): Data frame with the data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        null_df (pandas.DataFrame): Data frame consisting of two</span>
<span class="sd">            columns, &#39;count&#39; and &#39;percent&#39;, representing the number</span>
<span class="sd">            and percentage of columns missing in the data frame,</span>
<span class="sd">            respectively. The index will be the column names.</span>
<span class="sd">            Will only return columns that are missing values. If</span>
<span class="sd">            there are no missing values it will return an empty</span>
<span class="sd">            data frame.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">null_vals</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">null_vals</span> <span class="o">=</span> <span class="n">null_vals</span><span class="p">[</span><span class="n">null_vals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
    <span class="n">null_perc</span> <span class="o">=</span> <span class="n">null_vals</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">null_perc</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;percent&#39;</span>
    <span class="n">null_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">null_vals</span><span class="p">,</span> <span class="n">null_perc</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">null_df</span>

<span class="k">def</span> <span class="nf">calc_iqr</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="n">per</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span>
    <span class="n">iqr</span> <span class="o">=</span> <span class="n">per</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">per</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">per</span><span class="p">,</span> <span class="n">iqr</span>

<span class="k">def</span> <span class="nf">get_iqr_vals</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">per</span><span class="p">,</span> <span class="n">iqr</span> <span class="o">=</span> <span class="n">calc_iqr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">per</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">per</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span><span class="p">),</span> <span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">tmp</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">do_loop</span><span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Helper function for ensuring all the columns have a description &#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx1</span><span class="p">:</span>
        <span class="n">is_missing</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">idx2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">is_missing</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">is_missing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">compare_feature_keys</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Helper function for column descriptions &#39;&#39;&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Keys missing in description&quot;</span><span class="p">)</span>
    <span class="n">do_loop</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="s2">&quot;  - Missing key </span><span class="si">{}</span><span class="s2"> in description&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Keys missing in description&quot;</span><span class="p">)</span>
    <span class="n">do_loop</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;  - Missing key </span><span class="si">{}</span><span class="s2"> in data set&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">highlight_max</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">props</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">props</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">gen_cat_matrix</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Generate a heatmap representation of the number of values in a set</span>
<span class="sd">    of categorical columns. Uses the heatmap function in seaborn.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): Data frame with the pertinent data. This</span>
<span class="sd">            can be the complete data frame or a slice.</span>
<span class="sd">        x (str): Column name that will be used as the x-axis in the</span>
<span class="sd">            heatmap plot.</span>
<span class="sd">        y (str): Column name that will be used as the y-axis in the</span>
<span class="sd">            heatmap plot.</span>
<span class="sd">        fill (int, default=0): Number to use for filling in missing</span>
<span class="sd">            values when making the pivot table.</span>
<span class="sd">        color (str, default=&#39;tab:blue&#39;): Color to use for the box lines.</span>
<span class="sd">        linewidth (float, default=0.9): Linewidth for the box lines.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">pivot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tmp</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># sns.heatmap(pivot, annot=True, fmt=&#39;.0f&#39;, linecolor=color,</span>
    <span class="c1">#             linewidth=linewidth)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">pivot</span><span class="o">.</span><span class="n">style</span>
    <span class="n">p</span><span class="o">.</span><span class="n">highlight_max</span><span class="p">(</span><span class="n">props</span><span class="o">=</span><span class="s1">&#39;color:white;background-color:darkblue&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># p.set_properties(**{&#39;text-align&#39;: &#39;center&#39;})</span>
    <span class="n">p</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">([</span>
        <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;th:not(.index_name)&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="s1">&#39;background-color: #000066; color: white; text-align: center&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="s1">&#39;text-align:center; font-weight: bold;&#39;</span><span class="p">},</span>
    <span class="p">])</span>
    <span class="n">p</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;100px&#39;</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">p</span>

<span class="k">def</span> <span class="nf">fill_mode</span><span class="p">(</span><span class="n">sr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Function to calculate the mode and fill in missing values. &#39;&#39;&#39;</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sr</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">replace_price_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xaxis</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Replace the plot ticks in the given plot with hard-coded values</span>
<span class="sd">    determined for our purpose.</span>

<span class="sd">    Note:</span>
<span class="sd">        This will create axis ticks spaced every 10e3 units and set</span>
<span class="sd">        the tick labels to be in units of thousands.</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (matplotlib.axis.Axes): Matplotlib Axes object.</span>
<span class="sd">        xaxis (bool): Set that we are replacing the xaxis ticks.</span>
<span class="sd">        label (str, default=&#39;Price&#39;): Label preceeding the units.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">9e5</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">xaxis</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> / 10$^3</span><span class="se">\\</span><span class="s1">times$USD&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> / 10$^3</span><span class="se">\\</span><span class="s1">times$USD&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">gen_lotfront_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">group_cols</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to visualize how the replacement that we make for the missing</span>
<span class="sd">    values in the &#39;LotFrontage&#39; column will affect the overall values. We</span>
<span class="sd">    generate a plot for the effect using the average and the median grouping</span>
<span class="sd">    by the given columns. We also print out the number of remaining missing</span>
<span class="sd">    values in the feature column.</span>

<span class="sd">    Note:</span>
<span class="sd">        This is hard-coded for the &#39;LotFrontage&#39; column.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): Data frame with the pertinent data.</span>
<span class="sd">        group_cols (list): List with the column names that we will group by</span>
<span class="sd">            to calculate the mean and make the relvant replacements.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tmp</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group_cols</span><span class="p">)[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Missing values after average: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="n">replace_price_ticks</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="s1">&#39;New values&#39;</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Using average&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tmp</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group_cols</span><span class="p">)[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">median</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Missing values after median: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
    <span class="n">replace_price_ticks</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="s1">&#39;New values&#39;</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Using median&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;_data&#39;</span><span class="p">,</span> <span class="s1">&#39;data_description.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fn</span><span class="p">:</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">keys</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">contents</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">line</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">):</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">descrip</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">descrip</span>
        <span class="k">if</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">):</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="n">contents</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                <span class="n">contents</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span> <span class="k">break</span>
            <span class="n">contents</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">contents</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">contents</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;No categories&#39;</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</section>
<section id="Studying-data">
<h1>Studying data<a class="headerlink" href="#Studying-data" title="Link to this heading">#</a></h1>
<p>Looking at the first few rows of the data after reading it.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dtypes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MSSubClass</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;_data&#39;</span><span class="p">,</span> <span class="s1">&#39;train.csv&#39;</span><span class="p">),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtypes</span><span class="p">)</span>
<span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>Alley</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>LotConfig</th>
      <th>...</th>
      <th>PoolArea</th>
      <th>PoolQC</th>
      <th>Fence</th>
      <th>MiscFeature</th>
      <th>MiscVal</th>
      <th>MoSold</th>
      <th>YrSold</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
      <th>SalePrice</th>
    </tr>
    <tr>
      <th>Id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>60</td>
      <td>RL</td>
      <td>65.0</td>
      <td>8450</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>2</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>208500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20</td>
      <td>RL</td>
      <td>80.0</td>
      <td>9600</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>FR2</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>5</td>
      <td>2007</td>
      <td>WD</td>
      <td>Normal</td>
      <td>181500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>60</td>
      <td>RL</td>
      <td>68.0</td>
      <td>11250</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>9</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>223500</td>
    </tr>
    <tr>
      <th>4</th>
      <td>70</td>
      <td>RL</td>
      <td>60.0</td>
      <td>9550</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Corner</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>2</td>
      <td>2006</td>
      <td>WD</td>
      <td>Abnorml</td>
      <td>140000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>60</td>
      <td>RL</td>
      <td>84.0</td>
      <td>14260</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>FR2</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>12</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>250000</td>
    </tr>
  </tbody>
</table>
<p>5 rows  80 columns</p>
</div></div>
</div>
<section id="Checking-for-any-missing-values-in-the-original-data-set">
<h2>Checking for any missing values in the original data set<a class="headerlink" href="#Checking-for-any-missing-values-in-the-original-data-set" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vals</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PoolQC</th>
      <td>1453</td>
      <td>99.520548</td>
    </tr>
    <tr>
      <th>MiscFeature</th>
      <td>1406</td>
      <td>96.301370</td>
    </tr>
    <tr>
      <th>Alley</th>
      <td>1369</td>
      <td>93.767123</td>
    </tr>
    <tr>
      <th>Fence</th>
      <td>1179</td>
      <td>80.753425</td>
    </tr>
    <tr>
      <th>MasVnrType</th>
      <td>872</td>
      <td>59.726027</td>
    </tr>
    <tr>
      <th>FireplaceQu</th>
      <td>690</td>
      <td>47.260274</td>
    </tr>
    <tr>
      <th>LotFrontage</th>
      <td>259</td>
      <td>17.739726</td>
    </tr>
    <tr>
      <th>GarageType</th>
      <td>81</td>
      <td>5.547945</td>
    </tr>
    <tr>
      <th>GarageYrBlt</th>
      <td>81</td>
      <td>5.547945</td>
    </tr>
    <tr>
      <th>GarageFinish</th>
      <td>81</td>
      <td>5.547945</td>
    </tr>
    <tr>
      <th>GarageQual</th>
      <td>81</td>
      <td>5.547945</td>
    </tr>
    <tr>
      <th>GarageCond</th>
      <td>81</td>
      <td>5.547945</td>
    </tr>
    <tr>
      <th>BsmtFinType2</th>
      <td>38</td>
      <td>2.602740</td>
    </tr>
    <tr>
      <th>BsmtExposure</th>
      <td>38</td>
      <td>2.602740</td>
    </tr>
    <tr>
      <th>BsmtFinType1</th>
      <td>37</td>
      <td>2.534247</td>
    </tr>
    <tr>
      <th>BsmtCond</th>
      <td>37</td>
      <td>2.534247</td>
    </tr>
    <tr>
      <th>BsmtQual</th>
      <td>37</td>
      <td>2.534247</td>
    </tr>
    <tr>
      <th>MasVnrArea</th>
      <td>8</td>
      <td>0.547945</td>
    </tr>
    <tr>
      <th>Electrical</th>
      <td>1</td>
      <td>0.068493</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Making-sure-that-there-is-a-description-for-every-available-feature-column">
<h2>Making sure that there is a description for every available feature column<a class="headerlink" href="#Making-sure-that-there-is-a-description-for-every-available-feature-column" title="Link to this heading">#</a></h2>
<p>The column <code class="docutils literal notranslate"><span class="pre">'SalePrice'</span></code> is expected as this is the label we are trying to predict. It is not a feature in the data set.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_feature_keys</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">df_train</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Keys missing in description
  - Missing key SalePrice in description
Keys missing in description
</pre></div></div>
</div>
</section>
</section>
<section id="Data-Preprocessing">
<h1>Data Preprocessing<a class="headerlink" href="#Data-Preprocessing" title="Link to this heading">#</a></h1>
<p>Now that I know there are missing values in the data set <code class="docutils literal notranslate"><span class="pre">'train.csv'</span></code> I will go ahead and sort out what to do with those missing values.</p>
<p>For the sake of brevity when I come to filling in missing data and imputing values based on other columns I will just be using the data from this single imputation. I am aware that it is often better to consider multiple imputations and to run a model for each of those methods as this can give a better performing model for unobserved data that may not fit the trends in the imputation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<section id="Outliers">
<h2>Outliers<a class="headerlink" href="#Outliers" title="Link to this heading">#</a></h2>
<p>The first thing that I want to see is how normally distributed the housing price values are distributed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">2.5e4</span><span class="p">))</span>
<span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">9e5</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Price / 10$^3</span><span class="se">\\</span><span class="s1">times$USD&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Price / 10$^3\\times$USD&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_15_1.png" src="../_images/linear-regression_ames-housing-data_15_1.png" />
</div>
</div>
<p>We can see that there is a very nice normal distribution of values with only a few values above 500,000 with the vast majority of values in the 120,000 to 140,000 range. I feel confident with saying that as a whole the housing prices are normally distributed as a whole. However, the houses are located in different neighborhoods so it is worthwhile to look at the prices are distributed among the different neighborhoods.</p>
<p>Lets do this with a simple box plot that will also give an idea of outliers.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">replace_price_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_17_0.png" src="../_images/linear-regression_ames-housing-data_17_0.png" />
</div>
</div>
<p>In the figure above we can see that there are many data points that are identified by Seaborn to be outside of the <span class="math notranslate nohighlight">\(1.5 \times \text{IQR}\)</span> (Inter-Quartile Region). Lets look at how many are outside of this range for each neighborhood to see how much of the data falls outside this range.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_iqr_vals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total outside 1.5*IQR: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="n">tmp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Total outside 1.5*IQR: 65
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Neighborhood
NAmes      13
OldTown     8
Gilbert     8
BrkSide     6
Edwards     5
Sawyer      4
NWAmes      4
NoRidge     4
Crawfor     3
Mitchel     3
CollgCr     2
Somerst     2
NridgHt     2
SWISU       1
StoneBr     0
Timber      0
SawyerW     0
Blmngtn     0
NPkVill     0
Blueste     0
MeadowV     0
IDOTRR      0
ClearCr     0
BrDale      0
Veenker     0
dtype: int64
</pre></div></div>
</div>
<p>So there are a total of 65 values that fall outside of the <span class="math notranslate nohighlight">\(1.5 \times \text{IQR}\)</span>, corresponding to approximately 4.5% of the data set. While these can in fact be outliers in the data set, this criteria alone is not enough to consider them outliers as they may have some useful information to the overall trends that affect the sale prices of homes. Additionally, looking at the box plots there are many points that are close to the cutoff set by Seaborn.</p>
<p>With this in mind it would be a good idea to find which features have a large correlation with sale prices and identify any points that break from the actual trend. This would then affect our model as it would decrease the accuracy and reliability.</p>
<p>Lets start with looking at the features with the highest correlation with the sale price.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SalePrice       1.000000
OverallQual     0.790982
GrLivArea       0.708624
GarageCars      0.640409
GarageArea      0.623431
TotalBsmtSF     0.613581
1stFlrSF        0.605852
FullBath        0.560664
TotRmsAbvGrd    0.533723
YearBuilt       0.522897
YearRemodAdd    0.507101
GarageYrBlt     0.486362
Name: SalePrice, dtype: float64
</pre></div></div>
</div>
<p>We see that the feature columns <code class="docutils literal notranslate"><span class="pre">'OverallQual'</span></code> and <code class="docutils literal notranslate"><span class="pre">'GrLivArea'</span></code> have a correlation value over 70% and these features might be a good place to start looking for outliers.</p>
<p>Lets look at the price of the house with respect to the overall quality.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;OverallQual&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">iqr_high</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">iqr_low</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">median</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">qual</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;OverallQual&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> values with a quality of </span><span class="si">{}</span><span class="s2">. Not plotting the IQR.&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qual</span><span class="p">))</span>
        <span class="k">continue</span>
    <span class="n">per</span><span class="p">,</span> <span class="n">iqr</span> <span class="o">=</span> <span class="n">calc_iqr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qual</span><span class="p">)</span>
    <span class="n">iqr_high</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">per</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span><span class="p">)</span>
    <span class="n">iqr_low</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">per</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span><span class="p">)</span>
    <span class="n">median</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">iqr_low</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:cyan&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">iqr_high</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">replace_price_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Overall quality of home&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
There are 2 values with a quality of 1. Not plotting the IQR.
There are 3 values with a quality of 2. Not plotting the IQR.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Overall quality of home&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_23_2.png" src="../_images/linear-regression_ames-housing-data_23_2.png" />
</div>
</div>
<p>Here, we can actually see a pretty good relationship between the price of a home and the overall quality as denoted by the black dashed line representing the median for each quality rating. However, we can also see that there are a couple houses that have an overall quality rating of 10 and a price less than 200,000 where the cyan line representing <span class="math notranslate nohighlight">\(1.5 \times \text{IQR}\)</span> subtracted from the 25th percentile has a small dip in the trend.</p>
<p>Before we jump to conclusions lets look at another plot with the <code class="docutils literal notranslate"><span class="pre">'GrLivArea'</span></code> which is the above ground living area.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;GrLivArea&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">replace_price_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Living Area / ft$^2$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Living Area / ft$^2$&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_25_1.png" src="../_images/linear-regression_ames-housing-data_25_1.png" />
</div>
</div>
<p>And we see that there are two points that have a square footage greater than 4000 and a price less than 200,000. Now lets look at the data points and see if they are the same.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OverallQual&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">200e3</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>Alley</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>LotConfig</th>
      <th>...</th>
      <th>PoolArea</th>
      <th>PoolQC</th>
      <th>Fence</th>
      <th>MiscFeature</th>
      <th>MiscVal</th>
      <th>MoSold</th>
      <th>YrSold</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
      <th>SalePrice</th>
    </tr>
    <tr>
      <th>Id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>524</th>
      <td>60</td>
      <td>RL</td>
      <td>130.0</td>
      <td>40094</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>Bnk</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>10</td>
      <td>2007</td>
      <td>New</td>
      <td>Partial</td>
      <td>184750</td>
    </tr>
    <tr>
      <th>1299</th>
      <td>60</td>
      <td>RL</td>
      <td>313.0</td>
      <td>63887</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR3</td>
      <td>Bnk</td>
      <td>AllPub</td>
      <td>Corner</td>
      <td>...</td>
      <td>480</td>
      <td>Gd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>2008</td>
      <td>New</td>
      <td>Partial</td>
      <td>160000</td>
    </tr>
  </tbody>
</table>
<p>2 rows  80 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;GrLivArea&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">200e3</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>Alley</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>LotConfig</th>
      <th>...</th>
      <th>PoolArea</th>
      <th>PoolQC</th>
      <th>Fence</th>
      <th>MiscFeature</th>
      <th>MiscVal</th>
      <th>MoSold</th>
      <th>YrSold</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
      <th>SalePrice</th>
    </tr>
    <tr>
      <th>Id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>524</th>
      <td>60</td>
      <td>RL</td>
      <td>130.0</td>
      <td>40094</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>Bnk</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>10</td>
      <td>2007</td>
      <td>New</td>
      <td>Partial</td>
      <td>184750</td>
    </tr>
    <tr>
      <th>1299</th>
      <td>60</td>
      <td>RL</td>
      <td>313.0</td>
      <td>63887</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR3</td>
      <td>Bnk</td>
      <td>AllPub</td>
      <td>Corner</td>
      <td>...</td>
      <td>480</td>
      <td>Gd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>2008</td>
      <td>New</td>
      <td>Partial</td>
      <td>160000</td>
    </tr>
  </tbody>
</table>
<p>2 rows  80 columns</p>
</div></div>
</div>
<p>And we can see that they are the same data points. I am labeling these as outlier points since they dont fall nicely within the overall trend that we can see for <code class="docutils literal notranslate"><span class="pre">'OverallQual'</span></code> and <code class="docutils literal notranslate"><span class="pre">'GrLivArea'</span></code>. The values that we initially found to be above 500,000 are not outliers because they actually fall within the trends. They are just on the expensive end of the spectrum so they may give us valuable information for the model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idxs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OverallQual&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">200e3</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">idxs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;OverallQual&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">iqr_high</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">iqr_low</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">median</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">qual</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;OverallQual&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> values with a quality of </span><span class="si">{}</span><span class="s2">. Not plotting the IQR.&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qual</span><span class="p">))</span>
        <span class="k">continue</span>
    <span class="n">per</span><span class="p">,</span> <span class="n">iqr</span> <span class="o">=</span> <span class="n">calc_iqr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qual</span><span class="p">)</span>
    <span class="n">iqr_high</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">per</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span><span class="p">)</span>
    <span class="n">iqr_low</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">per</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span><span class="p">)</span>
    <span class="n">median</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">iqr_low</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:cyan&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">iqr_high</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">replace_price_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Overall quality of home&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
There are 2 values with a quality of 1. Not plotting the IQR.
There are 3 values with a quality of 2. Not plotting the IQR.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Overall quality of home&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_31_2.png" src="../_images/linear-regression_ames-housing-data_31_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;GrLivArea&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">replace_price_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Living Area / ft$^2$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Living Area / ft$^2$&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_32_1.png" src="../_images/linear-regression_ames-housing-data_32_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SalePrice      1.000000
OverallQual    0.795774
GrLivArea      0.734968
TotalBsmtSF    0.651153
GarageCars     0.641047
1stFlrSF       0.631530
GarageArea     0.629217
FullBath       0.562165
Name: SalePrice, dtype: float64
</pre></div></div>
</div>
<p>Now we have a nicely defined linear trend for the sale price with respect to the living area. We can also see that the correlation values went up slightly for <code class="docutils literal notranslate"><span class="pre">'OverallQual'</span></code> and <code class="docutils literal notranslate"><span class="pre">'GrLivArea'</span></code>.</p>
</section>
<section id="Electrical">
<h2>Electrical<a class="headerlink" href="#Electrical" title="Link to this heading">#</a></h2>
<p>First thing I want to determine is if there are any rows that I can simply drop because getting the values for the missing data might just not make too much sense and I can simply drop the data point altogether.</p>
<p>So lets look at the number of missing values again.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PoolQC</th>
      <td>1452</td>
      <td>99.588477</td>
    </tr>
    <tr>
      <th>MiscFeature</th>
      <td>1404</td>
      <td>96.296296</td>
    </tr>
    <tr>
      <th>Alley</th>
      <td>1367</td>
      <td>93.758573</td>
    </tr>
    <tr>
      <th>Fence</th>
      <td>1177</td>
      <td>80.727023</td>
    </tr>
    <tr>
      <th>MasVnrType</th>
      <td>872</td>
      <td>59.807956</td>
    </tr>
    <tr>
      <th>FireplaceQu</th>
      <td>690</td>
      <td>47.325103</td>
    </tr>
    <tr>
      <th>LotFrontage</th>
      <td>259</td>
      <td>17.764060</td>
    </tr>
    <tr>
      <th>GarageType</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageYrBlt</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageFinish</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageQual</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageCond</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>BsmtFinType2</th>
      <td>38</td>
      <td>2.606310</td>
    </tr>
    <tr>
      <th>BsmtExposure</th>
      <td>38</td>
      <td>2.606310</td>
    </tr>
    <tr>
      <th>BsmtFinType1</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
    <tr>
      <th>BsmtCond</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
    <tr>
      <th>BsmtQual</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
    <tr>
      <th>MasVnrArea</th>
      <td>8</td>
      <td>0.548697</td>
    </tr>
    <tr>
      <th>Electrical</th>
      <td>1</td>
      <td>0.068587</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The more curious one to study is the feature column <code class="docutils literal notranslate"><span class="pre">'Electrical'</span></code> as there is only one missing value that accounts for 0.07% of the availble data. Before I just drop the row I want to look at the description of it which is</p>
<pre>
Electrical: Electrical system

       SBrkr    Standard Circuit Breakers & Romex
       FuseA    Fuse Box over 60 AMP and all Romex wiring (Average)
       FuseF    60 AMP Fuse Box and mostly Romex wiring (Fair)
       FuseP    60 AMP Fuse Box and mostly knob & tube wiring (poor)
       Mix  Mixed
</pre><p>Typically, since there is only one row that is missing data it can be safe enough to just drop that row entirely as it only accounts for 0.07% of the data set. However, I want to try to infer the value based on some metric.</p>
<p>First lets look at some of the columns associated with the row that is missing data. I have identified the dwelling type (<code class="docutils literal notranslate"><span class="pre">'MSSubClass'</span></code>), zoning type (<code class="docutils literal notranslate"><span class="pre">'MSZoning'</span></code>), and neighborhood (<code class="docutils literal notranslate"><span class="pre">'Neighborhood'</span></code>) as potential columns that may be important in determining what kind of electrical system the building should have.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Electrical&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;Electrical&#39;</span><span class="p">,</span> <span class="s1">&#39;MSSubClass&#39;</span><span class="p">,</span> <span class="s1">&#39;MSZoning&#39;</span><span class="p">,</span> <span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="s1">&#39;SalePrice&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Electrical</th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>Neighborhood</th>
      <th>SalePrice</th>
    </tr>
    <tr>
      <th>Id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1380</th>
      <td>NaN</td>
      <td>80</td>
      <td>RL</td>
      <td>Timber</td>
      <td>167500</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Before we do anything lets look at some of the statistics from the sale price (<code class="docutils literal notranslate"><span class="pre">'SalePrice'</span></code>) with the type of electrical system.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Electrical&#39;</span><span class="p">)[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>Electrical</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SBrkr</th>
      <td>1332.0</td>
      <td>186846.810060</td>
      <td>79913.027373</td>
      <td>37900.0</td>
      <td>134500.0</td>
      <td>170000.0</td>
      <td>221000.00</td>
      <td>755000.0</td>
    </tr>
    <tr>
      <th>FuseA</th>
      <td>94.0</td>
      <td>122196.893617</td>
      <td>37511.376615</td>
      <td>34900.0</td>
      <td>98500.0</td>
      <td>121250.0</td>
      <td>143531.25</td>
      <td>239000.0</td>
    </tr>
    <tr>
      <th>FuseF</th>
      <td>27.0</td>
      <td>107675.444444</td>
      <td>30636.507376</td>
      <td>39300.0</td>
      <td>88500.0</td>
      <td>115000.0</td>
      <td>129950.00</td>
      <td>169500.0</td>
    </tr>
    <tr>
      <th>FuseP</th>
      <td>3.0</td>
      <td>97333.333333</td>
      <td>34645.827070</td>
      <td>73000.0</td>
      <td>77500.0</td>
      <td>82000.0</td>
      <td>109500.00</td>
      <td>137000.0</td>
    </tr>
    <tr>
      <th>Mix</th>
      <td>1.0</td>
      <td>67000.000000</td>
      <td>NaN</td>
      <td>67000.0</td>
      <td>67000.0</td>
      <td>67000.0</td>
      <td>67000.00</td>
      <td>67000.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can see that the average price is actually the highest with the standard circuit breakers and romex (<code class="docutils literal notranslate"><span class="pre">'SBrkr'</span></code>). However, you can also see that and electrical system <code class="docutils literal notranslate"><span class="pre">'SBrkr'</span></code> is actually in over 90% of the homes so its hard to make any conclusions on the effect of the electrical system on the final sale price.</p>
<p>Now lets try to take a look at the distributions in the other categorical values.</p>
<p>We start with a Box Plot of the sale prices against the electrical system used.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Electrical&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SBrkr&#39;</span><span class="p">,</span> <span class="s1">&#39;FuseA&#39;</span><span class="p">,</span> <span class="s1">&#39;FuseF&#39;</span><span class="p">,</span> <span class="s1">&#39;FuseP&#39;</span><span class="p">,</span> <span class="s1">&#39;Mix&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;SalePrice&#39;, ylabel=&#39;Electrical&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_42_1.png" src="../_images/linear-regression_ames-housing-data_42_1.png" />
</div>
</div>
<p>Since this is just a pictorial representation of the statistical data, the overall conclusions are the same. However, we can see that the median of the data for <code class="docutils literal notranslate"><span class="pre">'SBrkr'</span></code> is in the lower range of the distribution and there are a lot of points outside of the <span class="math notranslate nohighlight">\(1.5 \times \text{IQR}\)</span> range as defined in Seaborn. While this can, in some cases, be identified as outliers, this is clearly not that case as the points are continuous.</p>
<p>Next we have a set of pictorial representations of the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.pivot_table.html">Pandas pivot table</a> to look at the total number of electrical systems in each of the categorical classifications. At the end we will break down each of the plots and try to connect them with our data.</p>
<p>We start with the type dwelling.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_cat_matrix</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MSSubClass&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Electrical&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
#T_e65de th:not(.index_name) {
  background-color: #000066;
  color: white;
  text-align: center;
}
#T_e65de td {
  text-align: center;
  font-weight: bold;
}
#T_e65de_row0_col0, #T_e65de_row0_col1, #T_e65de_row0_col2, #T_e65de_row0_col3, #T_e65de_row1_col0, #T_e65de_row1_col1, #T_e65de_row1_col2, #T_e65de_row1_col3, #T_e65de_row2_col0, #T_e65de_row2_col1, #T_e65de_row2_col2, #T_e65de_row2_col3, #T_e65de_row3_col0, #T_e65de_row3_col1, #T_e65de_row3_col2, #T_e65de_row3_col3, #T_e65de_row4_col0, #T_e65de_row4_col1, #T_e65de_row4_col2, #T_e65de_row4_col3, #T_e65de_row5_col0, #T_e65de_row5_col1, #T_e65de_row5_col2, #T_e65de_row5_col3, #T_e65de_row6_col1, #T_e65de_row6_col2, #T_e65de_row6_col3, #T_e65de_row7_col0, #T_e65de_row7_col1, #T_e65de_row7_col2, #T_e65de_row7_col3, #T_e65de_row8_col0, #T_e65de_row8_col1, #T_e65de_row8_col2, #T_e65de_row8_col3, #T_e65de_row9_col0, #T_e65de_row9_col1, #T_e65de_row9_col2, #T_e65de_row9_col3, #T_e65de_row10_col0, #T_e65de_row10_col1, #T_e65de_row10_col2, #T_e65de_row10_col3, #T_e65de_row11_col0, #T_e65de_row11_col1, #T_e65de_row11_col2, #T_e65de_row11_col3, #T_e65de_row12_col0, #T_e65de_row12_col1, #T_e65de_row12_col2, #T_e65de_row12_col3, #T_e65de_row13_col0, #T_e65de_row13_col1, #T_e65de_row13_col2, #T_e65de_row13_col3, #T_e65de_row14_col0, #T_e65de_row14_col1, #T_e65de_row14_col2, #T_e65de_row14_col3 {
  width: 100px;
}
#T_e65de_row0_col4, #T_e65de_row1_col4, #T_e65de_row2_col4, #T_e65de_row3_col4, #T_e65de_row4_col4, #T_e65de_row5_col4, #T_e65de_row6_col0, #T_e65de_row6_col4, #T_e65de_row7_col4, #T_e65de_row8_col4, #T_e65de_row9_col4, #T_e65de_row10_col4, #T_e65de_row11_col4, #T_e65de_row12_col4, #T_e65de_row13_col4, #T_e65de_row14_col4 {
  color: white;
  background-color: darkblue;
  width: 100px;
}
</style>
<table id="T_e65de">
  <thead>
    <tr>
      <th class="index_name level0" >Electrical</th>
      <th id="T_e65de_level0_col0" class="col_heading level0 col0" >FuseA</th>
      <th id="T_e65de_level0_col1" class="col_heading level0 col1" >FuseF</th>
      <th id="T_e65de_level0_col2" class="col_heading level0 col2" >FuseP</th>
      <th id="T_e65de_level0_col3" class="col_heading level0 col3" >Mix</th>
      <th id="T_e65de_level0_col4" class="col_heading level0 col4" >SBrkr</th>
    </tr>
    <tr>
      <th class="index_name level0" >MSSubClass</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_e65de_level0_row0" class="row_heading level0 row0" >120</th>
      <td id="T_e65de_row0_col0" class="data row0 col0" >0</td>
      <td id="T_e65de_row0_col1" class="data row0 col1" >0</td>
      <td id="T_e65de_row0_col2" class="data row0 col2" >0</td>
      <td id="T_e65de_row0_col3" class="data row0 col3" >0</td>
      <td id="T_e65de_row0_col4" class="data row0 col4" >87</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row1" class="row_heading level0 row1" >160</th>
      <td id="T_e65de_row1_col0" class="data row1 col0" >0</td>
      <td id="T_e65de_row1_col1" class="data row1 col1" >0</td>
      <td id="T_e65de_row1_col2" class="data row1 col2" >0</td>
      <td id="T_e65de_row1_col3" class="data row1 col3" >0</td>
      <td id="T_e65de_row1_col4" class="data row1 col4" >63</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row2" class="row_heading level0 row2" >180</th>
      <td id="T_e65de_row2_col0" class="data row2 col0" >0</td>
      <td id="T_e65de_row2_col1" class="data row2 col1" >0</td>
      <td id="T_e65de_row2_col2" class="data row2 col2" >0</td>
      <td id="T_e65de_row2_col3" class="data row2 col3" >0</td>
      <td id="T_e65de_row2_col4" class="data row2 col4" >10</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row3" class="row_heading level0 row3" >190</th>
      <td id="T_e65de_row3_col0" class="data row3 col0" >5</td>
      <td id="T_e65de_row3_col1" class="data row3 col1" >1</td>
      <td id="T_e65de_row3_col2" class="data row3 col2" >1</td>
      <td id="T_e65de_row3_col3" class="data row3 col3" >0</td>
      <td id="T_e65de_row3_col4" class="data row3 col4" >23</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row4" class="row_heading level0 row4" >20</th>
      <td id="T_e65de_row4_col0" class="data row4 col0" >31</td>
      <td id="T_e65de_row4_col1" class="data row4 col1" >5</td>
      <td id="T_e65de_row4_col2" class="data row4 col2" >0</td>
      <td id="T_e65de_row4_col3" class="data row4 col3" >0</td>
      <td id="T_e65de_row4_col4" class="data row4 col4" >500</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row5" class="row_heading level0 row5" >30</th>
      <td id="T_e65de_row5_col0" class="data row5 col0" >18</td>
      <td id="T_e65de_row5_col1" class="data row5 col1" >4</td>
      <td id="T_e65de_row5_col2" class="data row5 col2" >1</td>
      <td id="T_e65de_row5_col3" class="data row5 col3" >1</td>
      <td id="T_e65de_row5_col4" class="data row5 col4" >45</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row6" class="row_heading level0 row6" >40</th>
      <td id="T_e65de_row6_col0" class="data row6 col0" >2</td>
      <td id="T_e65de_row6_col1" class="data row6 col1" >0</td>
      <td id="T_e65de_row6_col2" class="data row6 col2" >0</td>
      <td id="T_e65de_row6_col3" class="data row6 col3" >0</td>
      <td id="T_e65de_row6_col4" class="data row6 col4" >2</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row7" class="row_heading level0 row7" >45</th>
      <td id="T_e65de_row7_col0" class="data row7 col0" >3</td>
      <td id="T_e65de_row7_col1" class="data row7 col1" >2</td>
      <td id="T_e65de_row7_col2" class="data row7 col2" >0</td>
      <td id="T_e65de_row7_col3" class="data row7 col3" >0</td>
      <td id="T_e65de_row7_col4" class="data row7 col4" >7</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row8" class="row_heading level0 row8" >50</th>
      <td id="T_e65de_row8_col0" class="data row8 col0" >20</td>
      <td id="T_e65de_row8_col1" class="data row8 col1" >8</td>
      <td id="T_e65de_row8_col2" class="data row8 col2" >0</td>
      <td id="T_e65de_row8_col3" class="data row8 col3" >0</td>
      <td id="T_e65de_row8_col4" class="data row8 col4" >116</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row9" class="row_heading level0 row9" >60</th>
      <td id="T_e65de_row9_col0" class="data row9 col0" >0</td>
      <td id="T_e65de_row9_col1" class="data row9 col1" >0</td>
      <td id="T_e65de_row9_col2" class="data row9 col2" >0</td>
      <td id="T_e65de_row9_col3" class="data row9 col3" >0</td>
      <td id="T_e65de_row9_col4" class="data row9 col4" >297</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row10" class="row_heading level0 row10" >70</th>
      <td id="T_e65de_row10_col0" class="data row10 col0" >8</td>
      <td id="T_e65de_row10_col1" class="data row10 col1" >2</td>
      <td id="T_e65de_row10_col2" class="data row10 col2" >0</td>
      <td id="T_e65de_row10_col3" class="data row10 col3" >0</td>
      <td id="T_e65de_row10_col4" class="data row10 col4" >50</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row11" class="row_heading level0 row11" >75</th>
      <td id="T_e65de_row11_col0" class="data row11 col0" >2</td>
      <td id="T_e65de_row11_col1" class="data row11 col1" >0</td>
      <td id="T_e65de_row11_col2" class="data row11 col2" >0</td>
      <td id="T_e65de_row11_col3" class="data row11 col3" >0</td>
      <td id="T_e65de_row11_col4" class="data row11 col4" >14</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row12" class="row_heading level0 row12" >80</th>
      <td id="T_e65de_row12_col0" class="data row12 col0" >0</td>
      <td id="T_e65de_row12_col1" class="data row12 col1" >1</td>
      <td id="T_e65de_row12_col2" class="data row12 col2" >0</td>
      <td id="T_e65de_row12_col3" class="data row12 col3" >0</td>
      <td id="T_e65de_row12_col4" class="data row12 col4" >56</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row13" class="row_heading level0 row13" >85</th>
      <td id="T_e65de_row13_col0" class="data row13 col0" >0</td>
      <td id="T_e65de_row13_col1" class="data row13 col1" >0</td>
      <td id="T_e65de_row13_col2" class="data row13 col2" >0</td>
      <td id="T_e65de_row13_col3" class="data row13 col3" >0</td>
      <td id="T_e65de_row13_col4" class="data row13 col4" >20</td>
    </tr>
    <tr>
      <th id="T_e65de_level0_row14" class="row_heading level0 row14" >90</th>
      <td id="T_e65de_row14_col0" class="data row14 col0" >5</td>
      <td id="T_e65de_row14_col1" class="data row14 col1" >4</td>
      <td id="T_e65de_row14_col2" class="data row14 col2" >1</td>
      <td id="T_e65de_row14_col3" class="data row14 col3" >0</td>
      <td id="T_e65de_row14_col4" class="data row14 col4" >42</td>
    </tr>
  </tbody>
</table></div>
</div>
<p>Next is the zoning type.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_cat_matrix</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MSZoning&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Electrical&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
#T_55948 th:not(.index_name) {
  background-color: #000066;
  color: white;
  text-align: center;
}
#T_55948 td {
  text-align: center;
  font-weight: bold;
}
#T_55948_row0_col0, #T_55948_row0_col1, #T_55948_row0_col2, #T_55948_row0_col3, #T_55948_row1_col0, #T_55948_row1_col1, #T_55948_row1_col2, #T_55948_row1_col3, #T_55948_row2_col0, #T_55948_row2_col1, #T_55948_row2_col2, #T_55948_row2_col3, #T_55948_row3_col0, #T_55948_row3_col1, #T_55948_row3_col2, #T_55948_row3_col3, #T_55948_row4_col0, #T_55948_row4_col1, #T_55948_row4_col2, #T_55948_row4_col3 {
  width: 100px;
}
#T_55948_row0_col4, #T_55948_row1_col4, #T_55948_row2_col4, #T_55948_row3_col4, #T_55948_row4_col4 {
  color: white;
  background-color: darkblue;
  width: 100px;
}
</style>
<table id="T_55948">
  <thead>
    <tr>
      <th class="index_name level0" >Electrical</th>
      <th id="T_55948_level0_col0" class="col_heading level0 col0" >FuseA</th>
      <th id="T_55948_level0_col1" class="col_heading level0 col1" >FuseF</th>
      <th id="T_55948_level0_col2" class="col_heading level0 col2" >FuseP</th>
      <th id="T_55948_level0_col3" class="col_heading level0 col3" >Mix</th>
      <th id="T_55948_level0_col4" class="col_heading level0 col4" >SBrkr</th>
    </tr>
    <tr>
      <th class="index_name level0" >MSZoning</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_55948_level0_row0" class="row_heading level0 row0" >C (all)</th>
      <td id="T_55948_row0_col0" class="data row0 col0" >4</td>
      <td id="T_55948_row0_col1" class="data row0 col1" >0</td>
      <td id="T_55948_row0_col2" class="data row0 col2" >0</td>
      <td id="T_55948_row0_col3" class="data row0 col3" >0</td>
      <td id="T_55948_row0_col4" class="data row0 col4" >6</td>
    </tr>
    <tr>
      <th id="T_55948_level0_row1" class="row_heading level0 row1" >FV</th>
      <td id="T_55948_row1_col0" class="data row1 col0" >0</td>
      <td id="T_55948_row1_col1" class="data row1 col1" >0</td>
      <td id="T_55948_row1_col2" class="data row1 col2" >0</td>
      <td id="T_55948_row1_col3" class="data row1 col3" >0</td>
      <td id="T_55948_row1_col4" class="data row1 col4" >65</td>
    </tr>
    <tr>
      <th id="T_55948_level0_row2" class="row_heading level0 row2" >RH</th>
      <td id="T_55948_row2_col0" class="data row2 col0" >4</td>
      <td id="T_55948_row2_col1" class="data row2 col1" >1</td>
      <td id="T_55948_row2_col2" class="data row2 col2" >0</td>
      <td id="T_55948_row2_col3" class="data row2 col3" >0</td>
      <td id="T_55948_row2_col4" class="data row2 col4" >11</td>
    </tr>
    <tr>
      <th id="T_55948_level0_row3" class="row_heading level0 row3" >RL</th>
      <td id="T_55948_row3_col0" class="data row3 col0" >56</td>
      <td id="T_55948_row3_col1" class="data row3 col1" >18</td>
      <td id="T_55948_row3_col2" class="data row3 col2" >1</td>
      <td id="T_55948_row3_col3" class="data row3 col3" >0</td>
      <td id="T_55948_row3_col4" class="data row3 col4" >1073</td>
    </tr>
    <tr>
      <th id="T_55948_level0_row4" class="row_heading level0 row4" >RM</th>
      <td id="T_55948_row4_col0" class="data row4 col0" >30</td>
      <td id="T_55948_row4_col1" class="data row4 col1" >8</td>
      <td id="T_55948_row4_col2" class="data row4 col2" >2</td>
      <td id="T_55948_row4_col3" class="data row4 col3" >1</td>
      <td id="T_55948_row4_col4" class="data row4 col4" >177</td>
    </tr>
  </tbody>
</table></div>
</div>
<p>The neighborhood the dwelling is located in.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_cat_matrix</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Electrical&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
#T_a8a96 th:not(.index_name) {
  background-color: #000066;
  color: white;
  text-align: center;
}
#T_a8a96 td {
  text-align: center;
  font-weight: bold;
}
#T_a8a96_row0_col0, #T_a8a96_row0_col1, #T_a8a96_row0_col2, #T_a8a96_row0_col3, #T_a8a96_row1_col0, #T_a8a96_row1_col1, #T_a8a96_row1_col2, #T_a8a96_row1_col3, #T_a8a96_row2_col0, #T_a8a96_row2_col1, #T_a8a96_row2_col2, #T_a8a96_row2_col3, #T_a8a96_row3_col0, #T_a8a96_row3_col1, #T_a8a96_row3_col2, #T_a8a96_row3_col3, #T_a8a96_row4_col0, #T_a8a96_row4_col1, #T_a8a96_row4_col2, #T_a8a96_row4_col3, #T_a8a96_row5_col0, #T_a8a96_row5_col1, #T_a8a96_row5_col2, #T_a8a96_row5_col3, #T_a8a96_row6_col0, #T_a8a96_row6_col1, #T_a8a96_row6_col2, #T_a8a96_row6_col3, #T_a8a96_row7_col0, #T_a8a96_row7_col1, #T_a8a96_row7_col2, #T_a8a96_row7_col3, #T_a8a96_row8_col0, #T_a8a96_row8_col1, #T_a8a96_row8_col2, #T_a8a96_row8_col3, #T_a8a96_row9_col0, #T_a8a96_row9_col1, #T_a8a96_row9_col2, #T_a8a96_row9_col3, #T_a8a96_row10_col0, #T_a8a96_row10_col1, #T_a8a96_row10_col2, #T_a8a96_row10_col3, #T_a8a96_row11_col0, #T_a8a96_row11_col1, #T_a8a96_row11_col2, #T_a8a96_row11_col3, #T_a8a96_row12_col0, #T_a8a96_row12_col1, #T_a8a96_row12_col2, #T_a8a96_row12_col3, #T_a8a96_row13_col0, #T_a8a96_row13_col1, #T_a8a96_row13_col2, #T_a8a96_row13_col3, #T_a8a96_row14_col0, #T_a8a96_row14_col1, #T_a8a96_row14_col2, #T_a8a96_row14_col3, #T_a8a96_row15_col0, #T_a8a96_row15_col1, #T_a8a96_row15_col2, #T_a8a96_row15_col3, #T_a8a96_row16_col0, #T_a8a96_row16_col1, #T_a8a96_row16_col2, #T_a8a96_row16_col3, #T_a8a96_row17_col0, #T_a8a96_row17_col1, #T_a8a96_row17_col2, #T_a8a96_row17_col3, #T_a8a96_row18_col0, #T_a8a96_row18_col1, #T_a8a96_row18_col2, #T_a8a96_row18_col3, #T_a8a96_row19_col0, #T_a8a96_row19_col1, #T_a8a96_row19_col2, #T_a8a96_row19_col3, #T_a8a96_row20_col0, #T_a8a96_row20_col1, #T_a8a96_row20_col2, #T_a8a96_row20_col3, #T_a8a96_row21_col0, #T_a8a96_row21_col1, #T_a8a96_row21_col2, #T_a8a96_row21_col3, #T_a8a96_row22_col0, #T_a8a96_row22_col1, #T_a8a96_row22_col2, #T_a8a96_row22_col3, #T_a8a96_row23_col0, #T_a8a96_row23_col1, #T_a8a96_row23_col2, #T_a8a96_row23_col3, #T_a8a96_row24_col0, #T_a8a96_row24_col1, #T_a8a96_row24_col2, #T_a8a96_row24_col3 {
  width: 100px;
}
#T_a8a96_row0_col4, #T_a8a96_row1_col4, #T_a8a96_row2_col4, #T_a8a96_row3_col4, #T_a8a96_row4_col4, #T_a8a96_row5_col4, #T_a8a96_row6_col4, #T_a8a96_row7_col4, #T_a8a96_row8_col4, #T_a8a96_row9_col4, #T_a8a96_row10_col4, #T_a8a96_row11_col4, #T_a8a96_row12_col4, #T_a8a96_row13_col4, #T_a8a96_row14_col4, #T_a8a96_row15_col4, #T_a8a96_row16_col4, #T_a8a96_row17_col4, #T_a8a96_row18_col4, #T_a8a96_row19_col4, #T_a8a96_row20_col4, #T_a8a96_row21_col4, #T_a8a96_row22_col4, #T_a8a96_row23_col4, #T_a8a96_row24_col4 {
  color: white;
  background-color: darkblue;
  width: 100px;
}
</style>
<table id="T_a8a96">
  <thead>
    <tr>
      <th class="index_name level0" >Electrical</th>
      <th id="T_a8a96_level0_col0" class="col_heading level0 col0" >FuseA</th>
      <th id="T_a8a96_level0_col1" class="col_heading level0 col1" >FuseF</th>
      <th id="T_a8a96_level0_col2" class="col_heading level0 col2" >FuseP</th>
      <th id="T_a8a96_level0_col3" class="col_heading level0 col3" >Mix</th>
      <th id="T_a8a96_level0_col4" class="col_heading level0 col4" >SBrkr</th>
    </tr>
    <tr>
      <th class="index_name level0" >Neighborhood</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_a8a96_level0_row0" class="row_heading level0 row0" >Blmngtn</th>
      <td id="T_a8a96_row0_col0" class="data row0 col0" >0</td>
      <td id="T_a8a96_row0_col1" class="data row0 col1" >0</td>
      <td id="T_a8a96_row0_col2" class="data row0 col2" >0</td>
      <td id="T_a8a96_row0_col3" class="data row0 col3" >0</td>
      <td id="T_a8a96_row0_col4" class="data row0 col4" >17</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row1" class="row_heading level0 row1" >Blueste</th>
      <td id="T_a8a96_row1_col0" class="data row1 col0" >0</td>
      <td id="T_a8a96_row1_col1" class="data row1 col1" >0</td>
      <td id="T_a8a96_row1_col2" class="data row1 col2" >0</td>
      <td id="T_a8a96_row1_col3" class="data row1 col3" >0</td>
      <td id="T_a8a96_row1_col4" class="data row1 col4" >2</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row2" class="row_heading level0 row2" >BrDale</th>
      <td id="T_a8a96_row2_col0" class="data row2 col0" >0</td>
      <td id="T_a8a96_row2_col1" class="data row2 col1" >0</td>
      <td id="T_a8a96_row2_col2" class="data row2 col2" >0</td>
      <td id="T_a8a96_row2_col3" class="data row2 col3" >0</td>
      <td id="T_a8a96_row2_col4" class="data row2 col4" >16</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row3" class="row_heading level0 row3" >BrkSide</th>
      <td id="T_a8a96_row3_col0" class="data row3 col0" >13</td>
      <td id="T_a8a96_row3_col1" class="data row3 col1" >3</td>
      <td id="T_a8a96_row3_col2" class="data row3 col2" >0</td>
      <td id="T_a8a96_row3_col3" class="data row3 col3" >0</td>
      <td id="T_a8a96_row3_col4" class="data row3 col4" >42</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row4" class="row_heading level0 row4" >ClearCr</th>
      <td id="T_a8a96_row4_col0" class="data row4 col0" >2</td>
      <td id="T_a8a96_row4_col1" class="data row4 col1" >1</td>
      <td id="T_a8a96_row4_col2" class="data row4 col2" >0</td>
      <td id="T_a8a96_row4_col3" class="data row4 col3" >0</td>
      <td id="T_a8a96_row4_col4" class="data row4 col4" >25</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row5" class="row_heading level0 row5" >CollgCr</th>
      <td id="T_a8a96_row5_col0" class="data row5 col0" >0</td>
      <td id="T_a8a96_row5_col1" class="data row5 col1" >0</td>
      <td id="T_a8a96_row5_col2" class="data row5 col2" >0</td>
      <td id="T_a8a96_row5_col3" class="data row5 col3" >0</td>
      <td id="T_a8a96_row5_col4" class="data row5 col4" >150</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row6" class="row_heading level0 row6" >Crawfor</th>
      <td id="T_a8a96_row6_col0" class="data row6 col0" >3</td>
      <td id="T_a8a96_row6_col1" class="data row6 col1" >2</td>
      <td id="T_a8a96_row6_col2" class="data row6 col2" >0</td>
      <td id="T_a8a96_row6_col3" class="data row6 col3" >0</td>
      <td id="T_a8a96_row6_col4" class="data row6 col4" >46</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row7" class="row_heading level0 row7" >Edwards</th>
      <td id="T_a8a96_row7_col0" class="data row7 col0" >12</td>
      <td id="T_a8a96_row7_col1" class="data row7 col1" >9</td>
      <td id="T_a8a96_row7_col2" class="data row7 col2" >1</td>
      <td id="T_a8a96_row7_col3" class="data row7 col3" >0</td>
      <td id="T_a8a96_row7_col4" class="data row7 col4" >76</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row8" class="row_heading level0 row8" >Gilbert</th>
      <td id="T_a8a96_row8_col0" class="data row8 col0" >0</td>
      <td id="T_a8a96_row8_col1" class="data row8 col1" >0</td>
      <td id="T_a8a96_row8_col2" class="data row8 col2" >0</td>
      <td id="T_a8a96_row8_col3" class="data row8 col3" >0</td>
      <td id="T_a8a96_row8_col4" class="data row8 col4" >79</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row9" class="row_heading level0 row9" >IDOTRR</th>
      <td id="T_a8a96_row9_col0" class="data row9 col0" >10</td>
      <td id="T_a8a96_row9_col1" class="data row9 col1" >4</td>
      <td id="T_a8a96_row9_col2" class="data row9 col2" >0</td>
      <td id="T_a8a96_row9_col3" class="data row9 col3" >1</td>
      <td id="T_a8a96_row9_col4" class="data row9 col4" >22</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row10" class="row_heading level0 row10" >MeadowV</th>
      <td id="T_a8a96_row10_col0" class="data row10 col0" >0</td>
      <td id="T_a8a96_row10_col1" class="data row10 col1" >0</td>
      <td id="T_a8a96_row10_col2" class="data row10 col2" >0</td>
      <td id="T_a8a96_row10_col3" class="data row10 col3" >0</td>
      <td id="T_a8a96_row10_col4" class="data row10 col4" >17</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row11" class="row_heading level0 row11" >Mitchel</th>
      <td id="T_a8a96_row11_col0" class="data row11 col0" >1</td>
      <td id="T_a8a96_row11_col1" class="data row11 col1" >0</td>
      <td id="T_a8a96_row11_col2" class="data row11 col2" >0</td>
      <td id="T_a8a96_row11_col3" class="data row11 col3" >0</td>
      <td id="T_a8a96_row11_col4" class="data row11 col4" >48</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row12" class="row_heading level0 row12" >NAmes</th>
      <td id="T_a8a96_row12_col0" class="data row12 col0" >27</td>
      <td id="T_a8a96_row12_col1" class="data row12 col1" >3</td>
      <td id="T_a8a96_row12_col2" class="data row12 col2" >0</td>
      <td id="T_a8a96_row12_col3" class="data row12 col3" >0</td>
      <td id="T_a8a96_row12_col4" class="data row12 col4" >195</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row13" class="row_heading level0 row13" >NPkVill</th>
      <td id="T_a8a96_row13_col0" class="data row13 col0" >0</td>
      <td id="T_a8a96_row13_col1" class="data row13 col1" >0</td>
      <td id="T_a8a96_row13_col2" class="data row13 col2" >0</td>
      <td id="T_a8a96_row13_col3" class="data row13 col3" >0</td>
      <td id="T_a8a96_row13_col4" class="data row13 col4" >9</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row14" class="row_heading level0 row14" >NWAmes</th>
      <td id="T_a8a96_row14_col0" class="data row14 col0" >0</td>
      <td id="T_a8a96_row14_col1" class="data row14 col1" >0</td>
      <td id="T_a8a96_row14_col2" class="data row14 col2" >0</td>
      <td id="T_a8a96_row14_col3" class="data row14 col3" >0</td>
      <td id="T_a8a96_row14_col4" class="data row14 col4" >73</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row15" class="row_heading level0 row15" >NoRidge</th>
      <td id="T_a8a96_row15_col0" class="data row15 col0" >0</td>
      <td id="T_a8a96_row15_col1" class="data row15 col1" >0</td>
      <td id="T_a8a96_row15_col2" class="data row15 col2" >0</td>
      <td id="T_a8a96_row15_col3" class="data row15 col3" >0</td>
      <td id="T_a8a96_row15_col4" class="data row15 col4" >41</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row16" class="row_heading level0 row16" >NridgHt</th>
      <td id="T_a8a96_row16_col0" class="data row16 col0" >0</td>
      <td id="T_a8a96_row16_col1" class="data row16 col1" >0</td>
      <td id="T_a8a96_row16_col2" class="data row16 col2" >0</td>
      <td id="T_a8a96_row16_col3" class="data row16 col3" >0</td>
      <td id="T_a8a96_row16_col4" class="data row16 col4" >77</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row17" class="row_heading level0 row17" >OldTown</th>
      <td id="T_a8a96_row17_col0" class="data row17 col0" >21</td>
      <td id="T_a8a96_row17_col1" class="data row17 col1" >3</td>
      <td id="T_a8a96_row17_col2" class="data row17 col2" >2</td>
      <td id="T_a8a96_row17_col3" class="data row17 col3" >0</td>
      <td id="T_a8a96_row17_col4" class="data row17 col4" >87</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row18" class="row_heading level0 row18" >SWISU</th>
      <td id="T_a8a96_row18_col0" class="data row18 col0" >3</td>
      <td id="T_a8a96_row18_col1" class="data row18 col1" >2</td>
      <td id="T_a8a96_row18_col2" class="data row18 col2" >0</td>
      <td id="T_a8a96_row18_col3" class="data row18 col3" >0</td>
      <td id="T_a8a96_row18_col4" class="data row18 col4" >20</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row19" class="row_heading level0 row19" >Sawyer</th>
      <td id="T_a8a96_row19_col0" class="data row19 col0" >0</td>
      <td id="T_a8a96_row19_col1" class="data row19 col1" >0</td>
      <td id="T_a8a96_row19_col2" class="data row19 col2" >0</td>
      <td id="T_a8a96_row19_col3" class="data row19 col3" >0</td>
      <td id="T_a8a96_row19_col4" class="data row19 col4" >74</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row20" class="row_heading level0 row20" >SawyerW</th>
      <td id="T_a8a96_row20_col0" class="data row20 col0" >1</td>
      <td id="T_a8a96_row20_col1" class="data row20 col1" >0</td>
      <td id="T_a8a96_row20_col2" class="data row20 col2" >0</td>
      <td id="T_a8a96_row20_col3" class="data row20 col3" >0</td>
      <td id="T_a8a96_row20_col4" class="data row20 col4" >58</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row21" class="row_heading level0 row21" >Somerst</th>
      <td id="T_a8a96_row21_col0" class="data row21 col0" >0</td>
      <td id="T_a8a96_row21_col1" class="data row21 col1" >0</td>
      <td id="T_a8a96_row21_col2" class="data row21 col2" >0</td>
      <td id="T_a8a96_row21_col3" class="data row21 col3" >0</td>
      <td id="T_a8a96_row21_col4" class="data row21 col4" >86</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row22" class="row_heading level0 row22" >StoneBr</th>
      <td id="T_a8a96_row22_col0" class="data row22 col0" >0</td>
      <td id="T_a8a96_row22_col1" class="data row22 col1" >0</td>
      <td id="T_a8a96_row22_col2" class="data row22 col2" >0</td>
      <td id="T_a8a96_row22_col3" class="data row22 col3" >0</td>
      <td id="T_a8a96_row22_col4" class="data row22 col4" >25</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row23" class="row_heading level0 row23" >Timber</th>
      <td id="T_a8a96_row23_col0" class="data row23 col0" >1</td>
      <td id="T_a8a96_row23_col1" class="data row23 col1" >0</td>
      <td id="T_a8a96_row23_col2" class="data row23 col2" >0</td>
      <td id="T_a8a96_row23_col3" class="data row23 col3" >0</td>
      <td id="T_a8a96_row23_col4" class="data row23 col4" >36</td>
    </tr>
    <tr>
      <th id="T_a8a96_level0_row24" class="row_heading level0 row24" >Veenker</th>
      <td id="T_a8a96_row24_col0" class="data row24 col0" >0</td>
      <td id="T_a8a96_row24_col1" class="data row24 col1" >0</td>
      <td id="T_a8a96_row24_col2" class="data row24 col2" >0</td>
      <td id="T_a8a96_row24_col3" class="data row24 col3" >0</td>
      <td id="T_a8a96_row24_col4" class="data row24 col4" >11</td>
    </tr>
  </tbody>
</table></div>
</div>
<p>Based on the plots above I can see that there is no real connection between what type of electrical system a building has and its location, dwelling type, or zoning type. They pretty much all have a standard breaker system, <code class="docutils literal notranslate"><span class="pre">'SBrkr'</span></code>. With this in mind I believe that it is safe to perfrom a replacement of the missing value with the mode for the neighborhood the home is located.</p>
<p>The next two are trying to identify any relationship between the zoning type and the type of dwelling and neighborhood, respectively. I do not believe that this will give any extra valuable information, however, the North Ames neighborhood, <code class="docutils literal notranslate"><span class="pre">'NAmes'</span></code>, has the highest number of homes that use an electrcial system classified as <code class="docutils literal notranslate"><span class="pre">'FuseA'</span></code>. If there were more data points missing, it would be interesting to see if it would be necessary to consider some kind of distribution to try to retain the
original ratios the same.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_cat_matrix</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MSSubClass&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MSZoning&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
#T_07517 th:not(.index_name) {
  background-color: #000066;
  color: white;
  text-align: center;
}
#T_07517 td {
  text-align: center;
  font-weight: bold;
}
#T_07517_row0_col0, #T_07517_row0_col1, #T_07517_row0_col2, #T_07517_row0_col4, #T_07517_row1_col0, #T_07517_row1_col1, #T_07517_row1_col2, #T_07517_row1_col3, #T_07517_row2_col0, #T_07517_row2_col1, #T_07517_row2_col2, #T_07517_row2_col3, #T_07517_row3_col0, #T_07517_row3_col1, #T_07517_row3_col2, #T_07517_row3_col4, #T_07517_row4_col0, #T_07517_row4_col1, #T_07517_row4_col2, #T_07517_row4_col4, #T_07517_row5_col0, #T_07517_row5_col1, #T_07517_row5_col2, #T_07517_row6_col0, #T_07517_row6_col1, #T_07517_row6_col2, #T_07517_row7_col0, #T_07517_row7_col1, #T_07517_row7_col2, #T_07517_row7_col3, #T_07517_row8_col0, #T_07517_row8_col1, #T_07517_row8_col2, #T_07517_row8_col4, #T_07517_row9_col0, #T_07517_row9_col1, #T_07517_row9_col2, #T_07517_row9_col4, #T_07517_row10_col0, #T_07517_row10_col1, #T_07517_row10_col2, #T_07517_row10_col4, #T_07517_row11_col0, #T_07517_row11_col1, #T_07517_row11_col2, #T_07517_row11_col3, #T_07517_row12_col0, #T_07517_row12_col1, #T_07517_row12_col2, #T_07517_row12_col4, #T_07517_row13_col0, #T_07517_row13_col1, #T_07517_row13_col2, #T_07517_row13_col4, #T_07517_row14_col0, #T_07517_row14_col1, #T_07517_row14_col2, #T_07517_row14_col4 {
  width: 100px;
}
#T_07517_row0_col3, #T_07517_row1_col4, #T_07517_row2_col4, #T_07517_row3_col3, #T_07517_row4_col3, #T_07517_row5_col3, #T_07517_row5_col4, #T_07517_row6_col3, #T_07517_row6_col4, #T_07517_row7_col4, #T_07517_row8_col3, #T_07517_row9_col3, #T_07517_row10_col3, #T_07517_row11_col4, #T_07517_row12_col3, #T_07517_row13_col3, #T_07517_row14_col3 {
  color: white;
  background-color: darkblue;
  width: 100px;
}
</style>
<table id="T_07517">
  <thead>
    <tr>
      <th class="index_name level0" >MSZoning</th>
      <th id="T_07517_level0_col0" class="col_heading level0 col0" >C (all)</th>
      <th id="T_07517_level0_col1" class="col_heading level0 col1" >FV</th>
      <th id="T_07517_level0_col2" class="col_heading level0 col2" >RH</th>
      <th id="T_07517_level0_col3" class="col_heading level0 col3" >RL</th>
      <th id="T_07517_level0_col4" class="col_heading level0 col4" >RM</th>
    </tr>
    <tr>
      <th class="index_name level0" >MSSubClass</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_07517_level0_row0" class="row_heading level0 row0" >120</th>
      <td id="T_07517_row0_col0" class="data row0 col0" >0</td>
      <td id="T_07517_row0_col1" class="data row0 col1" >5</td>
      <td id="T_07517_row0_col2" class="data row0 col2" >2</td>
      <td id="T_07517_row0_col3" class="data row0 col3" >59</td>
      <td id="T_07517_row0_col4" class="data row0 col4" >21</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row1" class="row_heading level0 row1" >160</th>
      <td id="T_07517_row1_col0" class="data row1 col0" >0</td>
      <td id="T_07517_row1_col1" class="data row1 col1" >22</td>
      <td id="T_07517_row1_col2" class="data row1 col2" >0</td>
      <td id="T_07517_row1_col3" class="data row1 col3" >11</td>
      <td id="T_07517_row1_col4" class="data row1 col4" >30</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row2" class="row_heading level0 row2" >180</th>
      <td id="T_07517_row2_col0" class="data row2 col0" >0</td>
      <td id="T_07517_row2_col1" class="data row2 col1" >0</td>
      <td id="T_07517_row2_col2" class="data row2 col2" >0</td>
      <td id="T_07517_row2_col3" class="data row2 col3" >0</td>
      <td id="T_07517_row2_col4" class="data row2 col4" >10</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row3" class="row_heading level0 row3" >190</th>
      <td id="T_07517_row3_col0" class="data row3 col0" >1</td>
      <td id="T_07517_row3_col1" class="data row3 col1" >0</td>
      <td id="T_07517_row3_col2" class="data row3 col2" >2</td>
      <td id="T_07517_row3_col3" class="data row3 col3" >16</td>
      <td id="T_07517_row3_col4" class="data row3 col4" >11</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row4" class="row_heading level0 row4" >20</th>
      <td id="T_07517_row4_col0" class="data row4 col0" >2</td>
      <td id="T_07517_row4_col1" class="data row4 col1" >13</td>
      <td id="T_07517_row4_col2" class="data row4 col2" >3</td>
      <td id="T_07517_row4_col3" class="data row4 col3" >508</td>
      <td id="T_07517_row4_col4" class="data row4 col4" >10</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row5" class="row_heading level0 row5" >30</th>
      <td id="T_07517_row5_col0" class="data row5 col0" >2</td>
      <td id="T_07517_row5_col1" class="data row5 col1" >0</td>
      <td id="T_07517_row5_col2" class="data row5 col2" >1</td>
      <td id="T_07517_row5_col3" class="data row5 col3" >33</td>
      <td id="T_07517_row5_col4" class="data row5 col4" >33</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row6" class="row_heading level0 row6" >40</th>
      <td id="T_07517_row6_col0" class="data row6 col0" >0</td>
      <td id="T_07517_row6_col1" class="data row6 col1" >0</td>
      <td id="T_07517_row6_col2" class="data row6 col2" >0</td>
      <td id="T_07517_row6_col3" class="data row6 col3" >2</td>
      <td id="T_07517_row6_col4" class="data row6 col4" >2</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row7" class="row_heading level0 row7" >45</th>
      <td id="T_07517_row7_col0" class="data row7 col0" >0</td>
      <td id="T_07517_row7_col1" class="data row7 col1" >0</td>
      <td id="T_07517_row7_col2" class="data row7 col2" >1</td>
      <td id="T_07517_row7_col3" class="data row7 col3" >4</td>
      <td id="T_07517_row7_col4" class="data row7 col4" >7</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row8" class="row_heading level0 row8" >50</th>
      <td id="T_07517_row8_col0" class="data row8 col0" >4</td>
      <td id="T_07517_row8_col1" class="data row8 col1" >0</td>
      <td id="T_07517_row8_col2" class="data row8 col2" >1</td>
      <td id="T_07517_row8_col3" class="data row8 col3" >88</td>
      <td id="T_07517_row8_col4" class="data row8 col4" >51</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row9" class="row_heading level0 row9" >60</th>
      <td id="T_07517_row9_col0" class="data row9 col0" >0</td>
      <td id="T_07517_row9_col1" class="data row9 col1" >25</td>
      <td id="T_07517_row9_col2" class="data row9 col2" >0</td>
      <td id="T_07517_row9_col3" class="data row9 col3" >271</td>
      <td id="T_07517_row9_col4" class="data row9 col4" >1</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row10" class="row_heading level0 row10" >70</th>
      <td id="T_07517_row10_col0" class="data row10 col0" >1</td>
      <td id="T_07517_row10_col1" class="data row10 col1" >0</td>
      <td id="T_07517_row10_col2" class="data row10 col2" >3</td>
      <td id="T_07517_row10_col3" class="data row10 col3" >30</td>
      <td id="T_07517_row10_col4" class="data row10 col4" >26</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row11" class="row_heading level0 row11" >75</th>
      <td id="T_07517_row11_col0" class="data row11 col0" >0</td>
      <td id="T_07517_row11_col1" class="data row11 col1" >0</td>
      <td id="T_07517_row11_col2" class="data row11 col2" >0</td>
      <td id="T_07517_row11_col3" class="data row11 col3" >6</td>
      <td id="T_07517_row11_col4" class="data row11 col4" >10</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row12" class="row_heading level0 row12" >80</th>
      <td id="T_07517_row12_col0" class="data row12 col0" >0</td>
      <td id="T_07517_row12_col1" class="data row12 col1" >0</td>
      <td id="T_07517_row12_col2" class="data row12 col2" >0</td>
      <td id="T_07517_row12_col3" class="data row12 col3" >58</td>
      <td id="T_07517_row12_col4" class="data row12 col4" >0</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row13" class="row_heading level0 row13" >85</th>
      <td id="T_07517_row13_col0" class="data row13 col0" >0</td>
      <td id="T_07517_row13_col1" class="data row13 col1" >0</td>
      <td id="T_07517_row13_col2" class="data row13 col2" >0</td>
      <td id="T_07517_row13_col3" class="data row13 col3" >20</td>
      <td id="T_07517_row13_col4" class="data row13 col4" >0</td>
    </tr>
    <tr>
      <th id="T_07517_level0_row14" class="row_heading level0 row14" >90</th>
      <td id="T_07517_row14_col0" class="data row14 col0" >0</td>
      <td id="T_07517_row14_col1" class="data row14 col1" >0</td>
      <td id="T_07517_row14_col2" class="data row14 col2" >3</td>
      <td id="T_07517_row14_col3" class="data row14 col3" >43</td>
      <td id="T_07517_row14_col4" class="data row14 col4" >6</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_cat_matrix</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MSZoning&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
#T_ab9ec th:not(.index_name) {
  background-color: #000066;
  color: white;
  text-align: center;
}
#T_ab9ec td {
  text-align: center;
  font-weight: bold;
}
#T_ab9ec_row0_col0, #T_ab9ec_row0_col1, #T_ab9ec_row0_col2, #T_ab9ec_row0_col4, #T_ab9ec_row1_col0, #T_ab9ec_row1_col1, #T_ab9ec_row1_col2, #T_ab9ec_row1_col3, #T_ab9ec_row2_col0, #T_ab9ec_row2_col1, #T_ab9ec_row2_col2, #T_ab9ec_row2_col3, #T_ab9ec_row3_col0, #T_ab9ec_row3_col1, #T_ab9ec_row3_col2, #T_ab9ec_row3_col3, #T_ab9ec_row4_col0, #T_ab9ec_row4_col1, #T_ab9ec_row4_col2, #T_ab9ec_row4_col4, #T_ab9ec_row5_col0, #T_ab9ec_row5_col1, #T_ab9ec_row5_col2, #T_ab9ec_row5_col4, #T_ab9ec_row6_col0, #T_ab9ec_row6_col1, #T_ab9ec_row6_col2, #T_ab9ec_row6_col4, #T_ab9ec_row7_col0, #T_ab9ec_row7_col1, #T_ab9ec_row7_col2, #T_ab9ec_row7_col4, #T_ab9ec_row8_col0, #T_ab9ec_row8_col1, #T_ab9ec_row8_col2, #T_ab9ec_row8_col4, #T_ab9ec_row9_col0, #T_ab9ec_row9_col1, #T_ab9ec_row9_col2, #T_ab9ec_row9_col3, #T_ab9ec_row10_col0, #T_ab9ec_row10_col1, #T_ab9ec_row10_col2, #T_ab9ec_row10_col3, #T_ab9ec_row11_col0, #T_ab9ec_row11_col1, #T_ab9ec_row11_col2, #T_ab9ec_row11_col4, #T_ab9ec_row12_col0, #T_ab9ec_row12_col1, #T_ab9ec_row12_col2, #T_ab9ec_row12_col4, #T_ab9ec_row13_col0, #T_ab9ec_row13_col1, #T_ab9ec_row13_col2, #T_ab9ec_row13_col4, #T_ab9ec_row14_col0, #T_ab9ec_row14_col1, #T_ab9ec_row14_col2, #T_ab9ec_row14_col4, #T_ab9ec_row15_col0, #T_ab9ec_row15_col1, #T_ab9ec_row15_col2, #T_ab9ec_row15_col4, #T_ab9ec_row16_col0, #T_ab9ec_row16_col1, #T_ab9ec_row16_col2, #T_ab9ec_row16_col4, #T_ab9ec_row17_col0, #T_ab9ec_row17_col1, #T_ab9ec_row17_col2, #T_ab9ec_row17_col3, #T_ab9ec_row18_col0, #T_ab9ec_row18_col1, #T_ab9ec_row18_col2, #T_ab9ec_row18_col4, #T_ab9ec_row19_col0, #T_ab9ec_row19_col1, #T_ab9ec_row19_col2, #T_ab9ec_row19_col4, #T_ab9ec_row20_col0, #T_ab9ec_row20_col1, #T_ab9ec_row20_col2, #T_ab9ec_row20_col4, #T_ab9ec_row21_col0, #T_ab9ec_row21_col2, #T_ab9ec_row21_col3, #T_ab9ec_row21_col4, #T_ab9ec_row22_col0, #T_ab9ec_row22_col1, #T_ab9ec_row22_col2, #T_ab9ec_row22_col4, #T_ab9ec_row23_col0, #T_ab9ec_row23_col1, #T_ab9ec_row23_col2, #T_ab9ec_row23_col4, #T_ab9ec_row24_col0, #T_ab9ec_row24_col1, #T_ab9ec_row24_col2, #T_ab9ec_row24_col4 {
  width: 100px;
}
#T_ab9ec_row0_col3, #T_ab9ec_row1_col4, #T_ab9ec_row2_col4, #T_ab9ec_row3_col4, #T_ab9ec_row4_col3, #T_ab9ec_row5_col3, #T_ab9ec_row6_col3, #T_ab9ec_row7_col3, #T_ab9ec_row8_col3, #T_ab9ec_row9_col4, #T_ab9ec_row10_col4, #T_ab9ec_row11_col3, #T_ab9ec_row12_col3, #T_ab9ec_row13_col3, #T_ab9ec_row14_col3, #T_ab9ec_row15_col3, #T_ab9ec_row16_col3, #T_ab9ec_row17_col4, #T_ab9ec_row18_col3, #T_ab9ec_row19_col3, #T_ab9ec_row20_col3, #T_ab9ec_row21_col1, #T_ab9ec_row22_col3, #T_ab9ec_row23_col3, #T_ab9ec_row24_col3 {
  color: white;
  background-color: darkblue;
  width: 100px;
}
</style>
<table id="T_ab9ec">
  <thead>
    <tr>
      <th class="index_name level0" >MSZoning</th>
      <th id="T_ab9ec_level0_col0" class="col_heading level0 col0" >C (all)</th>
      <th id="T_ab9ec_level0_col1" class="col_heading level0 col1" >FV</th>
      <th id="T_ab9ec_level0_col2" class="col_heading level0 col2" >RH</th>
      <th id="T_ab9ec_level0_col3" class="col_heading level0 col3" >RL</th>
      <th id="T_ab9ec_level0_col4" class="col_heading level0 col4" >RM</th>
    </tr>
    <tr>
      <th class="index_name level0" >Neighborhood</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_ab9ec_level0_row0" class="row_heading level0 row0" >Blmngtn</th>
      <td id="T_ab9ec_row0_col0" class="data row0 col0" >0</td>
      <td id="T_ab9ec_row0_col1" class="data row0 col1" >0</td>
      <td id="T_ab9ec_row0_col2" class="data row0 col2" >0</td>
      <td id="T_ab9ec_row0_col3" class="data row0 col3" >16</td>
      <td id="T_ab9ec_row0_col4" class="data row0 col4" >1</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row1" class="row_heading level0 row1" >Blueste</th>
      <td id="T_ab9ec_row1_col0" class="data row1 col0" >0</td>
      <td id="T_ab9ec_row1_col1" class="data row1 col1" >0</td>
      <td id="T_ab9ec_row1_col2" class="data row1 col2" >0</td>
      <td id="T_ab9ec_row1_col3" class="data row1 col3" >0</td>
      <td id="T_ab9ec_row1_col4" class="data row1 col4" >2</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row2" class="row_heading level0 row2" >BrDale</th>
      <td id="T_ab9ec_row2_col0" class="data row2 col0" >0</td>
      <td id="T_ab9ec_row2_col1" class="data row2 col1" >0</td>
      <td id="T_ab9ec_row2_col2" class="data row2 col2" >0</td>
      <td id="T_ab9ec_row2_col3" class="data row2 col3" >0</td>
      <td id="T_ab9ec_row2_col4" class="data row2 col4" >16</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row3" class="row_heading level0 row3" >BrkSide</th>
      <td id="T_ab9ec_row3_col0" class="data row3 col0" >0</td>
      <td id="T_ab9ec_row3_col1" class="data row3 col1" >0</td>
      <td id="T_ab9ec_row3_col2" class="data row3 col2" >0</td>
      <td id="T_ab9ec_row3_col3" class="data row3 col3" >28</td>
      <td id="T_ab9ec_row3_col4" class="data row3 col4" >30</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row4" class="row_heading level0 row4" >ClearCr</th>
      <td id="T_ab9ec_row4_col0" class="data row4 col0" >0</td>
      <td id="T_ab9ec_row4_col1" class="data row4 col1" >0</td>
      <td id="T_ab9ec_row4_col2" class="data row4 col2" >0</td>
      <td id="T_ab9ec_row4_col3" class="data row4 col3" >28</td>
      <td id="T_ab9ec_row4_col4" class="data row4 col4" >0</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row5" class="row_heading level0 row5" >CollgCr</th>
      <td id="T_ab9ec_row5_col0" class="data row5 col0" >0</td>
      <td id="T_ab9ec_row5_col1" class="data row5 col1" >0</td>
      <td id="T_ab9ec_row5_col2" class="data row5 col2" >0</td>
      <td id="T_ab9ec_row5_col3" class="data row5 col3" >140</td>
      <td id="T_ab9ec_row5_col4" class="data row5 col4" >10</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row6" class="row_heading level0 row6" >Crawfor</th>
      <td id="T_ab9ec_row6_col0" class="data row6 col0" >0</td>
      <td id="T_ab9ec_row6_col1" class="data row6 col1" >0</td>
      <td id="T_ab9ec_row6_col2" class="data row6 col2" >2</td>
      <td id="T_ab9ec_row6_col3" class="data row6 col3" >46</td>
      <td id="T_ab9ec_row6_col4" class="data row6 col4" >3</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row7" class="row_heading level0 row7" >Edwards</th>
      <td id="T_ab9ec_row7_col0" class="data row7 col0" >0</td>
      <td id="T_ab9ec_row7_col1" class="data row7 col1" >0</td>
      <td id="T_ab9ec_row7_col2" class="data row7 col2" >2</td>
      <td id="T_ab9ec_row7_col3" class="data row7 col3" >88</td>
      <td id="T_ab9ec_row7_col4" class="data row7 col4" >8</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row8" class="row_heading level0 row8" >Gilbert</th>
      <td id="T_ab9ec_row8_col0" class="data row8 col0" >0</td>
      <td id="T_ab9ec_row8_col1" class="data row8 col1" >0</td>
      <td id="T_ab9ec_row8_col2" class="data row8 col2" >0</td>
      <td id="T_ab9ec_row8_col3" class="data row8 col3" >79</td>
      <td id="T_ab9ec_row8_col4" class="data row8 col4" >0</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row9" class="row_heading level0 row9" >IDOTRR</th>
      <td id="T_ab9ec_row9_col0" class="data row9 col0" >9</td>
      <td id="T_ab9ec_row9_col1" class="data row9 col1" >0</td>
      <td id="T_ab9ec_row9_col2" class="data row9 col2" >0</td>
      <td id="T_ab9ec_row9_col3" class="data row9 col3" >0</td>
      <td id="T_ab9ec_row9_col4" class="data row9 col4" >28</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row10" class="row_heading level0 row10" >MeadowV</th>
      <td id="T_ab9ec_row10_col0" class="data row10 col0" >0</td>
      <td id="T_ab9ec_row10_col1" class="data row10 col1" >0</td>
      <td id="T_ab9ec_row10_col2" class="data row10 col2" >0</td>
      <td id="T_ab9ec_row10_col3" class="data row10 col3" >0</td>
      <td id="T_ab9ec_row10_col4" class="data row10 col4" >17</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row11" class="row_heading level0 row11" >Mitchel</th>
      <td id="T_ab9ec_row11_col0" class="data row11 col0" >0</td>
      <td id="T_ab9ec_row11_col1" class="data row11 col1" >0</td>
      <td id="T_ab9ec_row11_col2" class="data row11 col2" >0</td>
      <td id="T_ab9ec_row11_col3" class="data row11 col3" >44</td>
      <td id="T_ab9ec_row11_col4" class="data row11 col4" >5</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row12" class="row_heading level0 row12" >NAmes</th>
      <td id="T_ab9ec_row12_col0" class="data row12 col0" >0</td>
      <td id="T_ab9ec_row12_col1" class="data row12 col1" >0</td>
      <td id="T_ab9ec_row12_col2" class="data row12 col2" >2</td>
      <td id="T_ab9ec_row12_col3" class="data row12 col3" >223</td>
      <td id="T_ab9ec_row12_col4" class="data row12 col4" >0</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row13" class="row_heading level0 row13" >NPkVill</th>
      <td id="T_ab9ec_row13_col0" class="data row13 col0" >0</td>
      <td id="T_ab9ec_row13_col1" class="data row13 col1" >0</td>
      <td id="T_ab9ec_row13_col2" class="data row13 col2" >0</td>
      <td id="T_ab9ec_row13_col3" class="data row13 col3" >9</td>
      <td id="T_ab9ec_row13_col4" class="data row13 col4" >0</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row14" class="row_heading level0 row14" >NWAmes</th>
      <td id="T_ab9ec_row14_col0" class="data row14 col0" >0</td>
      <td id="T_ab9ec_row14_col1" class="data row14 col1" >0</td>
      <td id="T_ab9ec_row14_col2" class="data row14 col2" >0</td>
      <td id="T_ab9ec_row14_col3" class="data row14 col3" >73</td>
      <td id="T_ab9ec_row14_col4" class="data row14 col4" >0</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row15" class="row_heading level0 row15" >NoRidge</th>
      <td id="T_ab9ec_row15_col0" class="data row15 col0" >0</td>
      <td id="T_ab9ec_row15_col1" class="data row15 col1" >0</td>
      <td id="T_ab9ec_row15_col2" class="data row15 col2" >0</td>
      <td id="T_ab9ec_row15_col3" class="data row15 col3" >41</td>
      <td id="T_ab9ec_row15_col4" class="data row15 col4" >0</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row16" class="row_heading level0 row16" >NridgHt</th>
      <td id="T_ab9ec_row16_col0" class="data row16 col0" >0</td>
      <td id="T_ab9ec_row16_col1" class="data row16 col1" >0</td>
      <td id="T_ab9ec_row16_col2" class="data row16 col2" >0</td>
      <td id="T_ab9ec_row16_col3" class="data row16 col3" >76</td>
      <td id="T_ab9ec_row16_col4" class="data row16 col4" >1</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row17" class="row_heading level0 row17" >OldTown</th>
      <td id="T_ab9ec_row17_col0" class="data row17 col0" >1</td>
      <td id="T_ab9ec_row17_col1" class="data row17 col1" >0</td>
      <td id="T_ab9ec_row17_col2" class="data row17 col2" >0</td>
      <td id="T_ab9ec_row17_col3" class="data row17 col3" >17</td>
      <td id="T_ab9ec_row17_col4" class="data row17 col4" >95</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row18" class="row_heading level0 row18" >SWISU</th>
      <td id="T_ab9ec_row18_col0" class="data row18 col0" >0</td>
      <td id="T_ab9ec_row18_col1" class="data row18 col1" >0</td>
      <td id="T_ab9ec_row18_col2" class="data row18 col2" >5</td>
      <td id="T_ab9ec_row18_col3" class="data row18 col3" >20</td>
      <td id="T_ab9ec_row18_col4" class="data row18 col4" >0</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row19" class="row_heading level0 row19" >Sawyer</th>
      <td id="T_ab9ec_row19_col0" class="data row19 col0" >0</td>
      <td id="T_ab9ec_row19_col1" class="data row19 col1" >0</td>
      <td id="T_ab9ec_row19_col2" class="data row19 col2" >0</td>
      <td id="T_ab9ec_row19_col3" class="data row19 col3" >72</td>
      <td id="T_ab9ec_row19_col4" class="data row19 col4" >2</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row20" class="row_heading level0 row20" >SawyerW</th>
      <td id="T_ab9ec_row20_col0" class="data row20 col0" >0</td>
      <td id="T_ab9ec_row20_col1" class="data row20 col1" >0</td>
      <td id="T_ab9ec_row20_col2" class="data row20 col2" >5</td>
      <td id="T_ab9ec_row20_col3" class="data row20 col3" >54</td>
      <td id="T_ab9ec_row20_col4" class="data row20 col4" >0</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row21" class="row_heading level0 row21" >Somerst</th>
      <td id="T_ab9ec_row21_col0" class="data row21 col0" >0</td>
      <td id="T_ab9ec_row21_col1" class="data row21 col1" >65</td>
      <td id="T_ab9ec_row21_col2" class="data row21 col2" >0</td>
      <td id="T_ab9ec_row21_col3" class="data row21 col3" >21</td>
      <td id="T_ab9ec_row21_col4" class="data row21 col4" >0</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row22" class="row_heading level0 row22" >StoneBr</th>
      <td id="T_ab9ec_row22_col0" class="data row22 col0" >0</td>
      <td id="T_ab9ec_row22_col1" class="data row22 col1" >0</td>
      <td id="T_ab9ec_row22_col2" class="data row22 col2" >0</td>
      <td id="T_ab9ec_row22_col3" class="data row22 col3" >25</td>
      <td id="T_ab9ec_row22_col4" class="data row22 col4" >0</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row23" class="row_heading level0 row23" >Timber</th>
      <td id="T_ab9ec_row23_col0" class="data row23 col0" >0</td>
      <td id="T_ab9ec_row23_col1" class="data row23 col1" >0</td>
      <td id="T_ab9ec_row23_col2" class="data row23 col2" >0</td>
      <td id="T_ab9ec_row23_col3" class="data row23 col3" >38</td>
      <td id="T_ab9ec_row23_col4" class="data row23 col4" >0</td>
    </tr>
    <tr>
      <th id="T_ab9ec_level0_row24" class="row_heading level0 row24" >Veenker</th>
      <td id="T_ab9ec_row24_col0" class="data row24 col0" >0</td>
      <td id="T_ab9ec_row24_col1" class="data row24 col1" >0</td>
      <td id="T_ab9ec_row24_col2" class="data row24 col2" >0</td>
      <td id="T_ab9ec_row24_col3" class="data row24 col3" >11</td>
      <td id="T_ab9ec_row24_col4" class="data row24 col4" >0</td>
    </tr>
  </tbody>
</table></div>
</div>
<p>So as mentioned before there is no extra information that we will gather from the two plots above.</p>
<p>Now lets make the replacement with the overall mode of the neighborhood the missing value is in.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="s1">&#39;MSSubClass&#39;</span><span class="p">,</span> <span class="s1">&#39;MSZoning&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Electrical&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group_cols</span><span class="p">)[</span><span class="s1">&#39;Electrical&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">fill_mode</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PoolQC</th>
      <td>1452</td>
      <td>99.588477</td>
    </tr>
    <tr>
      <th>MiscFeature</th>
      <td>1404</td>
      <td>96.296296</td>
    </tr>
    <tr>
      <th>Alley</th>
      <td>1367</td>
      <td>93.758573</td>
    </tr>
    <tr>
      <th>Fence</th>
      <td>1177</td>
      <td>80.727023</td>
    </tr>
    <tr>
      <th>MasVnrType</th>
      <td>872</td>
      <td>59.807956</td>
    </tr>
    <tr>
      <th>FireplaceQu</th>
      <td>690</td>
      <td>47.325103</td>
    </tr>
    <tr>
      <th>LotFrontage</th>
      <td>259</td>
      <td>17.764060</td>
    </tr>
    <tr>
      <th>GarageType</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageYrBlt</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageFinish</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageQual</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageCond</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>BsmtExposure</th>
      <td>38</td>
      <td>2.606310</td>
    </tr>
    <tr>
      <th>BsmtFinType2</th>
      <td>38</td>
      <td>2.606310</td>
    </tr>
    <tr>
      <th>BsmtFinType1</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
    <tr>
      <th>BsmtCond</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
    <tr>
      <th>BsmtQual</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
    <tr>
      <th>MasVnrArea</th>
      <td>8</td>
      <td>0.548697</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>And we have gotten rid of the missing value.</p>
<p>In reality, it might actually be good enough to just drop that row altogether since it is one row accounting for 0.07% of the data set. However, if there are more values missing, ~40 rows or 2.7%, just dropping the rows might not be the best thing to do. Especially if we end up doing this for multiple columns that may not share the same indeces. It can really add up in the end.</p>
</section>
<section id="Masonry-Veneer">
<h2>Masonry Veneer<a class="headerlink" href="#Masonry-Veneer" title="Link to this heading">#</a></h2>
<p>From the previous cell we can see that we are missing values in the <code class="docutils literal notranslate"><span class="pre">'MasVnrArea'</span></code> and <code class="docutils literal notranslate"><span class="pre">'MasVnrType'</span></code> columns. Below is a description of the columns.</p>
<pre>
MasVnrType: Masonry veneer type

       BrkCmn   Brick Common
       BrkFace  Brick Face
       CBlock   Cinder Block
       None None
       Stone    Stone

MasVnrArea: Masonry veneer area in square feet
</pre><p>So we can see that it has to do with the masonry veneer that the house has. More importantly, we can see that for the <code class="docutils literal notranslate"><span class="pre">'MasVnrType'</span></code>, when there is a missing value it just means that there is no masonry veneer. This can be further supported by the <code class="docutils literal notranslate"><span class="pre">'MasVnrArea'</span></code>, which is the area covered by the masonry veneer and should be zero if the <code class="docutils literal notranslate"><span class="pre">'MasVnrType'</span></code> is missing a value. However, we must be careful as the <code class="docutils literal notranslate"><span class="pre">'MasVnrArea'</span></code> feature is missing some data points. As this is a numerical value it
might be hard to determine what it should be. I will go into this one in more detail later on.</p>
<p>So lets first take where the values of <code class="docutils literal notranslate"><span class="pre">'MasVnrType'</span></code> is missing a value and see what are the values of <code class="docutils literal notranslate"><span class="pre">'MasVnrArea'</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MasVnrType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;MasVnrType&#39;</span><span class="p">,</span> <span class="s1">&#39;MasVnrArea&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MasVnrType  MasVnrArea
NaN         0.0           859
            NaN             8
            1.0             2
            288.0           1
            312.0           1
            344.0           1
Name: count, dtype: int64
</pre></div></div>
</div>
<p>What we see is that there are a lot of places where the <code class="docutils literal notranslate"><span class="pre">'MasVnrType'</span></code> is missing a value <strong>and</strong> <code class="docutils literal notranslate"><span class="pre">'MasVnrArea'</span></code> is 0.0. However, when we were looking at the percentges of missing values above we could see that the <code class="docutils literal notranslate"><span class="pre">'MasVnrArea'</span></code> feature was missing values as well and we can see that here.</p>
<p>Therefore, we have to be careful in how we perform the replacement as we must replace the <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values in <code class="docutils literal notranslate"><span class="pre">'MasVnrType'</span></code> for <code class="docutils literal notranslate"><span class="pre">'None'</span></code> only where <code class="docutils literal notranslate"><span class="pre">'MasVnrArea'</span></code> is 0.0.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MasVnrType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MasVnrArea&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;MasVnrType&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
</pre></div>
</div>
</div>
<p>Now lets try to determine what we should do with the other values in these columns.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MasVnrType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;MasVnrType&#39;</span><span class="p">,</span> <span class="s1">&#39;MasVnrArea&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MasVnrType  MasVnrArea
NaN         NaN           8
            1.0           2
            288.0         1
            312.0         1
            344.0         1
Name: count, dtype: int64
</pre></div></div>
</div>
<p>Now we are just missing values when <code class="docutils literal notranslate"><span class="pre">'MasVnrArea'</span></code> is either <code class="docutils literal notranslate"><span class="pre">NaN</span></code> or non-zero.</p>
<p>Lets look into the distribution of the values with respect to the sale price. What I want to determine is how correlated are the values and will some simple replacements create outliers in our data set.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MasVnrType&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Masonry Veneer Type&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sale Price / $&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Sale Price / $&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_63_1.png" src="../_images/linear-regression_ames-housing-data_63_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MasVnrArea&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Masonry Veneer Area / ft$^2$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sale Price / $&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Sale Price / $&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_64_1.png" src="../_images/linear-regression_ames-housing-data_64_1.png" />
</div>
</div>
<p>There does not seem to ba a very large correlation between the type of masonry veneer or its type on the sale price of a home. Due to this I will go ahead and replace all <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values with 0.0 and <code class="docutils literal notranslate"><span class="pre">'None'</span></code> in the <code class="docutils literal notranslate"><span class="pre">'MasVnrArea'</span></code> and <code class="docutils literal notranslate"><span class="pre">'MasVnrType'</span></code>, respectively. Since there is no large correlation between the values and the sale price I feel confident in also making the replacement of all the values of <code class="docutils literal notranslate"><span class="pre">'MasVnrType'</span></code> with <code class="docutils literal notranslate"><span class="pre">'None'</span></code>, even when the <code class="docutils literal notranslate"><span class="pre">'MasVnrArea'</span></code> is not zero.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MasVnrArea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MasVnrArea&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;MasVnrType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MasVnrType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PoolQC</th>
      <td>1452</td>
      <td>99.588477</td>
    </tr>
    <tr>
      <th>MiscFeature</th>
      <td>1404</td>
      <td>96.296296</td>
    </tr>
    <tr>
      <th>Alley</th>
      <td>1367</td>
      <td>93.758573</td>
    </tr>
    <tr>
      <th>Fence</th>
      <td>1177</td>
      <td>80.727023</td>
    </tr>
    <tr>
      <th>FireplaceQu</th>
      <td>690</td>
      <td>47.325103</td>
    </tr>
    <tr>
      <th>LotFrontage</th>
      <td>259</td>
      <td>17.764060</td>
    </tr>
    <tr>
      <th>GarageType</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageYrBlt</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageFinish</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageQual</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageCond</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>BsmtExposure</th>
      <td>38</td>
      <td>2.606310</td>
    </tr>
    <tr>
      <th>BsmtFinType2</th>
      <td>38</td>
      <td>2.606310</td>
    </tr>
    <tr>
      <th>BsmtQual</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
    <tr>
      <th>BsmtCond</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
    <tr>
      <th>BsmtFinType1</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>And now we have no missing values for the <code class="docutils literal notranslate"><span class="pre">'MasVnrType'</span></code> when the <code class="docutils literal notranslate"><span class="pre">'MasVnrArea'</span></code> is zero.</p>
</section>
<section id="Basement">
<h2>Basement<a class="headerlink" href="#Basement" title="Link to this heading">#</a></h2>
<p>The next values that I want to tackle are going to be concerned with the basement data. The description for all the available feature columns for basements are</p>
<pre>
BsmtQual: Evaluates the height of the basement

       Ex   Excellent (100+ inches)
       Gd   Good (90-99 inches)
       TA   Typical (80-89 inches)
       Fa   Fair (70-79 inches)
       Po   Poor (&lt;70 inches
       NA   No Basement

BsmtCond: Evaluates the general condition of the basement

       Ex   Excellent
       Gd   Good
       TA   Typical - slight dampness allowed
       Fa   Fair - dampness or some cracking or settling
       Po   Poor - Severe cracking, settling, or wetness
       NA   No Basement

BsmtExposure: Refers to walkout or garden level walls

       Gd   Good Exposure
       Av   Average Exposure (split levels or foyers typically score average or above)
       Mn   Mimimum Exposure
       No   No Exposure
       NA   No Basement

BsmtFinType1: Rating of basement finished area

       GLQ  Good Living Quarters
       ALQ  Average Living Quarters
       BLQ  Below Average Living Quarters
       Rec  Average Rec Room
       LwQ  Low Quality
       Unf  Unfinshed
       NA   No Basement

BsmtFinSF1: Type 1 finished square feet

BsmtFinType2: Rating of basement finished area (if multiple types)

       GLQ  Good Living Quarters
       ALQ  Average Living Quarters
       BLQ  Below Average Living Quarters
       Rec  Average Rec Room
       LwQ  Low Quality
       Unf  Unfinshed
       NA   No Basement

BsmtFinSF2: Type 2 finished square feet

BsmtUnfSF: Unfinished square feet of basement area

TotalBsmtSF: Total square feet of basement area
</pre><p>So, similar to before we can see that a lot of the data that is missing for the basements is categorical and we can probably fill in a lot of the <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values with <code class="docutils literal notranslate"><span class="pre">'None'</span></code> as there is probably no basement there.</p>
<p>Lets confirm this below by getting the square footage and other things like we did for the <code class="docutils literal notranslate"><span class="pre">'MasVnrType'</span></code> feature.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtCond&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;bsmt&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BsmtQual  BsmtCond  BsmtExposure  BsmtFinType1  BsmtFinSF1  BsmtFinType2  BsmtFinSF2  BsmtUnfSF  TotalBsmtSF  BsmtFullBath  BsmtHalfBath
NaN       NaN       NaN           NaN           0           NaN           0           0          0            0             0               37
Name: count, dtype: int64
</pre></div></div>
</div>
<p>And we can see that for all the categorical values, if the numerical features, <code class="docutils literal notranslate"><span class="pre">'BsmtFinSF1'</span></code>, <code class="docutils literal notranslate"><span class="pre">'BsmtFinSF2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'BsmtUnfSF'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'TotalBsmtSF'</span></code>, it is missing a value, supporting our initial guess. However, looking at the data frame for the missing values</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;BsmtQual&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtCond&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtExposure&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtFinType1&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtFinType2&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BsmtQual</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
    <tr>
      <th>BsmtCond</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
    <tr>
      <th>BsmtExposure</th>
      <td>38</td>
      <td>2.606310</td>
    </tr>
    <tr>
      <th>BsmtFinType1</th>
      <td>37</td>
      <td>2.537723</td>
    </tr>
    <tr>
      <th>BsmtFinType2</th>
      <td>38</td>
      <td>2.606310</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Lets go ahead and replace the categorical values for all the columns when <code class="docutils literal notranslate"><span class="pre">'BsmtCond'</span></code> is <code class="docutils literal notranslate"><span class="pre">NaN</span></code> with <code class="docutils literal notranslate"><span class="pre">'None'</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BsmtQual&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtCond&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtExposure&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtFinType1&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtFinType2&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtCond&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">cat_cols</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
</pre></div>
</div>
</div>
<p>Lets check for missing values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PoolQC</th>
      <td>1452</td>
      <td>99.588477</td>
    </tr>
    <tr>
      <th>MiscFeature</th>
      <td>1404</td>
      <td>96.296296</td>
    </tr>
    <tr>
      <th>Alley</th>
      <td>1367</td>
      <td>93.758573</td>
    </tr>
    <tr>
      <th>Fence</th>
      <td>1177</td>
      <td>80.727023</td>
    </tr>
    <tr>
      <th>FireplaceQu</th>
      <td>690</td>
      <td>47.325103</td>
    </tr>
    <tr>
      <th>LotFrontage</th>
      <td>259</td>
      <td>17.764060</td>
    </tr>
    <tr>
      <th>GarageType</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageYrBlt</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageFinish</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageQual</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>GarageCond</th>
      <td>81</td>
      <td>5.555556</td>
    </tr>
    <tr>
      <th>BsmtExposure</th>
      <td>1</td>
      <td>0.068587</td>
    </tr>
    <tr>
      <th>BsmtFinType2</th>
      <td>1</td>
      <td>0.068587</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>And we still have values missing for the <code class="docutils literal notranslate"><span class="pre">'BsmtExposure'</span></code> and <code class="docutils literal notranslate"><span class="pre">'BsmtFinType2'</span></code> columns.</p>
<p>Below is the data for when the other two columns are missing data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtFinType2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtCond&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()),</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;bsmt&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BsmtQual</th>
      <th>BsmtCond</th>
      <th>BsmtExposure</th>
      <th>BsmtFinType1</th>
      <th>BsmtFinSF1</th>
      <th>BsmtFinType2</th>
      <th>BsmtFinSF2</th>
      <th>BsmtUnfSF</th>
      <th>TotalBsmtSF</th>
      <th>BsmtFullBath</th>
      <th>BsmtHalfBath</th>
    </tr>
    <tr>
      <th>Id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>333</th>
      <td>Gd</td>
      <td>TA</td>
      <td>No</td>
      <td>GLQ</td>
      <td>1124</td>
      <td>NaN</td>
      <td>479</td>
      <td>1603</td>
      <td>3206</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtExposure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtCond&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()),</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;bsmt&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BsmtQual</th>
      <th>BsmtCond</th>
      <th>BsmtExposure</th>
      <th>BsmtFinType1</th>
      <th>BsmtFinSF1</th>
      <th>BsmtFinType2</th>
      <th>BsmtFinSF2</th>
      <th>BsmtUnfSF</th>
      <th>TotalBsmtSF</th>
      <th>BsmtFullBath</th>
      <th>BsmtHalfBath</th>
    </tr>
    <tr>
      <th>Id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>949</th>
      <td>Gd</td>
      <td>TA</td>
      <td>NaN</td>
      <td>Unf</td>
      <td>0</td>
      <td>Unf</td>
      <td>0</td>
      <td>936</td>
      <td>936</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Well, we can actually see that <code class="docutils literal notranslate"><span class="pre">'BsmtFinType2'</span></code> and <code class="docutils literal notranslate"><span class="pre">'BsmtExposure'</span></code> do not share missing values on the same row and this data should not actually be missing. Data for <code class="docutils literal notranslate"><span class="pre">'BsmtFinType2'</span></code> should only be missing when <code class="docutils literal notranslate"><span class="pre">'BsmtFinType2'</span></code> is 0 and <code class="docutils literal notranslate"><span class="pre">'BsmtExposure'</span></code> should only be missing when there is no basement, i.e. when <code class="docutils literal notranslate"><span class="pre">'TotalBsmtSF'</span></code> is 0. This is somewhat problematic and will require looking at a few other things before deciding on what should be done.</p>
<p>So lets take a look at how dependent the sale price, <code class="docutils literal notranslate"><span class="pre">'SalePrice'</span></code>, is to the different categorical values for the basement in our data set. The y-axis will be labeled from worst (bottom) to best (top) in terms of quality or the metric used for the categorical labels.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BsmtQual&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtCond&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtExposure&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtFinType1&#39;</span><span class="p">,</span> <span class="s1">&#39;BsmtFinType2&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Quality&#39;</span><span class="p">,</span> <span class="s1">&#39;Condition&#39;</span><span class="p">,</span> <span class="s1">&#39;Exposure&#39;</span><span class="p">,</span> <span class="s1">&#39;Finish&#39;</span><span class="p">,</span> <span class="s1">&#39;Finish (if multiple)&#39;</span><span class="p">]</span>
<span class="n">orders</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">BsmtQual</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ex&#39;</span><span class="p">,</span> <span class="s1">&#39;Gd&#39;</span><span class="p">,</span> <span class="s1">&#39;TA&#39;</span><span class="p">,</span> <span class="s1">&#39;Fa&#39;</span><span class="p">,</span> <span class="s1">&#39;Po&#39;</span><span class="p">],</span>
              <span class="n">BsmtCond</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ex&#39;</span><span class="p">,</span> <span class="s1">&#39;Gd&#39;</span><span class="p">,</span> <span class="s1">&#39;TA&#39;</span><span class="p">,</span> <span class="s1">&#39;Fa&#39;</span><span class="p">,</span> <span class="s1">&#39;Po&#39;</span><span class="p">],</span>
              <span class="n">BsmtExposure</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Gd&#39;</span><span class="p">,</span> <span class="s1">&#39;Av&#39;</span><span class="p">,</span> <span class="s1">&#39;Mn&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span>
              <span class="n">BsmtFinType1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GLQ&#39;</span><span class="p">,</span> <span class="s1">&#39;ALQ&#39;</span><span class="p">,</span> <span class="s1">&#39;BLQ&#39;</span><span class="p">,</span> <span class="s1">&#39;Rec&#39;</span><span class="p">,</span> <span class="s1">&#39;LwQ&#39;</span><span class="p">,</span> <span class="s1">&#39;Unf&#39;</span><span class="p">],</span>
              <span class="n">BsmtFinType2</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GLQ&#39;</span><span class="p">,</span> <span class="s1">&#39;ALQ&#39;</span><span class="p">,</span> <span class="s1">&#39;BLQ&#39;</span><span class="p">,</span> <span class="s1">&#39;Rec&#39;</span><span class="p">,</span> <span class="s1">&#39;LwQ&#39;</span><span class="p">,</span> <span class="s1">&#39;Unf&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">labels</span><span class="p">)):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">order</span><span class="o">=</span><span class="n">orders</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">2.5e4</span><span class="p">))</span>
    <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">9e5</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">]</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Price / 10$^3</span><span class="se">\\</span><span class="s1">times$USD&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">label</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39; (</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_81_0.png" src="../_images/linear-regression_ames-housing-data_81_0.png" />
</div>
</div>
<p>What we can see here is that there is a stronger correlation between the sale price of a house and the basement quality (<code class="docutils literal notranslate"><span class="pre">'BsmtQual'</span></code>) and condition (<code class="docutils literal notranslate"><span class="pre">'BsmtCond'</span></code>) than with the other categorical features. From before we are missing values in the <code class="docutils literal notranslate"><span class="pre">'BsmtExposure'</span></code> and <code class="docutils literal notranslate"><span class="pre">'BsmtFinType2'</span></code> features, but we have already seen that they should not be missing. Based on what I see on the plots above I believe it is safe to replace the missing values for the two rows with an imputed value based on
the mode of the column with respect to the neighborhood the house is in and the type of dwelling. Before we do so lets make sure that this will actually make sense.</p>
<p>Heres the data for the row missing the <code class="docutils literal notranslate"><span class="pre">'BsmtExposure'</span></code> value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtExposure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtCond&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()),</span>
       <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;bsmt&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="s1">&#39;MSSubClass&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Id</th>
      <th>949</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BsmtQual</th>
      <td>Gd</td>
    </tr>
    <tr>
      <th>BsmtCond</th>
      <td>TA</td>
    </tr>
    <tr>
      <th>BsmtExposure</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>BsmtFinType1</th>
      <td>Unf</td>
    </tr>
    <tr>
      <th>BsmtFinSF1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>BsmtFinType2</th>
      <td>Unf</td>
    </tr>
    <tr>
      <th>BsmtFinSF2</th>
      <td>0</td>
    </tr>
    <tr>
      <th>BsmtUnfSF</th>
      <td>936</td>
    </tr>
    <tr>
      <th>TotalBsmtSF</th>
      <td>936</td>
    </tr>
    <tr>
      <th>BsmtFullBath</th>
      <td>0</td>
    </tr>
    <tr>
      <th>BsmtHalfBath</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Neighborhood</th>
      <td>CollgCr</td>
    </tr>
    <tr>
      <th>MSSubClass</th>
      <td>60</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>A breakdown of the basement exposure for each dwelling type in the College Creek (<code class="docutils literal notranslate"><span class="pre">'CollgCr'</span></code>) neighborhood.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="s1">&#39;MSSubClass&#39;</span><span class="p">])[</span><span class="s1">&#39;BsmtExposure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;CollgCr&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MSSubClass  BsmtExposure
120         Av               7
            Gd               2
            Mn               1
20          Av              35
            No              32
            Gd               8
            Mn               6
60          No              33
            Av              11
            Mn               7
            NaN              1
            Gd               1
80          Av               2
            Gd               1
85          Av               3
Name: count, dtype: int64
</pre></div></div>
</div>
<p>We know that our missing row has the label <code class="docutils literal notranslate"><span class="pre">'60'</span></code> for the dwelling type and we see that the mode is that there is no exposure. I believe this is a fair enough assumption given that this is a 2 story home. So lets make the replacement in a generalized fashion with the transform method in pandas.</p>
<p><strong>Some of the potential pitfalls of this type of replacement is that if the mode of the data is actually ``NaN`` then you may end up just replacing a ``NaN`` value with another ``NaN`` value.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtExposure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="s1">&#39;MSSubClass&#39;</span><span class="p">])[</span><span class="s1">&#39;BsmtExposure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">fill_mode</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>And now lets look at the other problematic column, <code class="docutils literal notranslate"><span class="pre">'BsmtFinType2'</span></code>.</p>
<p>Here is the data in the missing row.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtFinType2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtCond&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()),</span>
       <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;bsmt&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="s1">&#39;MSSubClass&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Id</th>
      <th>333</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BsmtQual</th>
      <td>Gd</td>
    </tr>
    <tr>
      <th>BsmtCond</th>
      <td>TA</td>
    </tr>
    <tr>
      <th>BsmtExposure</th>
      <td>No</td>
    </tr>
    <tr>
      <th>BsmtFinType1</th>
      <td>GLQ</td>
    </tr>
    <tr>
      <th>BsmtFinSF1</th>
      <td>1124</td>
    </tr>
    <tr>
      <th>BsmtFinType2</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>BsmtFinSF2</th>
      <td>479</td>
    </tr>
    <tr>
      <th>BsmtUnfSF</th>
      <td>1603</td>
    </tr>
    <tr>
      <th>TotalBsmtSF</th>
      <td>3206</td>
    </tr>
    <tr>
      <th>BsmtFullBath</th>
      <td>1</td>
    </tr>
    <tr>
      <th>BsmtHalfBath</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Neighborhood</th>
      <td>NridgHt</td>
    </tr>
    <tr>
      <th>MSSubClass</th>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="s1">&#39;MSSubClass&#39;</span><span class="p">])[</span><span class="s1">&#39;BsmtFinType2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;NridgHt&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MSSubClass  BsmtFinType2
120         Unf             19
160         Unf              3
20          Unf             30
            ALQ              1
            NaN              1
60          Unf             23
Name: count, dtype: int64
</pre></div></div>
</div>
<p>So most of the houses actually dont have a second type of finished basement, or its <code class="docutils literal notranslate"><span class="pre">'Unf'</span></code>.</p>
<p>Lets see what are the values for the <code class="docutils literal notranslate"><span class="pre">'BsmtFinType2'</span></code> when the <code class="docutils literal notranslate"><span class="pre">'BsmtFinSF2'</span></code> is greater than zero.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BsmtFinSF2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;MSSubClass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;20&#39;</span><span class="p">)[</span><span class="s1">&#39;BsmtFinType2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BsmtFinType2
Rec    29
LwQ    28
BLQ    17
ALQ     7
GLQ     5
Name: count, dtype: int64
</pre></div></div>
</div>
<p>And we see that the data should have a value that is not <code class="docutils literal notranslate"><span class="pre">'Unf'</span></code>.</p>
<p>The problem with this row is that the mode for the finish type and the type of dwelling is actually unfinished, <code class="docutils literal notranslate"><span class="pre">'Unf'</span></code>, which would create a contradiction in the data. Since it is just one row I will actually drop it. In the grand scheme of things keeping this one row will not result in a large change in the final results.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">333</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PoolQC</th>
      <td>1451</td>
      <td>99.588195</td>
    </tr>
    <tr>
      <th>MiscFeature</th>
      <td>1403</td>
      <td>96.293754</td>
    </tr>
    <tr>
      <th>Alley</th>
      <td>1366</td>
      <td>93.754290</td>
    </tr>
    <tr>
      <th>Fence</th>
      <td>1176</td>
      <td>80.713795</td>
    </tr>
    <tr>
      <th>FireplaceQu</th>
      <td>690</td>
      <td>47.357584</td>
    </tr>
    <tr>
      <th>LotFrontage</th>
      <td>259</td>
      <td>17.776253</td>
    </tr>
    <tr>
      <th>GarageType</th>
      <td>81</td>
      <td>5.559369</td>
    </tr>
    <tr>
      <th>GarageYrBlt</th>
      <td>81</td>
      <td>5.559369</td>
    </tr>
    <tr>
      <th>GarageFinish</th>
      <td>81</td>
      <td>5.559369</td>
    </tr>
    <tr>
      <th>GarageQual</th>
      <td>81</td>
      <td>5.559369</td>
    </tr>
    <tr>
      <th>GarageCond</th>
      <td>81</td>
      <td>5.559369</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>And we have eliminated all missing data points pertaining to the basement.</p>
</section>
<section id="Garage">
<h2>Garage<a class="headerlink" href="#Garage" title="Link to this heading">#</a></h2>
<p>Here, I want to figure out the features pertaining to information on the garage. The values from the description file are.</p>
<pre>
GarageType: Garage location

       2Types   More than one type of garage
       Attchd   Attached to home
       Basment  Basement Garage
       BuiltIn  Built-In (Garage part of house - typically has room above garage)
       CarPort  Car Port
       Detchd   Detached from home
       NA   No Garage

GarageYrBlt: Year garage was built

GarageFinish: Interior finish of the garage

       Fin  Finished
       RFn  Rough Finished
       Unf  Unfinished
       NA   No Garage

GarageCars: Size of garage in car capacity

GarageArea: Size of garage in square feet

GarageQual: Garage quality

       Ex   Excellent
       Gd   Good
       TA   Typical/Average
       Fa   Fair
       Po   Poor
       NA   No Garage

GarageCond: Garage condition

       Ex   Excellent
       Gd   Good
       TA   Typical/Average
       Fa   Fair
       Po   Poor
       NA   No Garage
</pre><p>Lets first take a look at the current state of the columns data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;GarageType&#39;</span><span class="p">,</span> <span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">,</span> <span class="s1">&#39;GarageFinish&#39;</span><span class="p">,</span> <span class="s1">&#39;GarageQual&#39;</span><span class="p">,</span> <span class="s1">&#39;GarageCond&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>GarageType</th>
      <td>81</td>
      <td>5.559369</td>
    </tr>
    <tr>
      <th>GarageYrBlt</th>
      <td>81</td>
      <td>5.559369</td>
    </tr>
    <tr>
      <th>GarageFinish</th>
      <td>81</td>
      <td>5.559369</td>
    </tr>
    <tr>
      <th>GarageQual</th>
      <td>81</td>
      <td>5.559369</td>
    </tr>
    <tr>
      <th>GarageCond</th>
      <td>81</td>
      <td>5.559369</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We see that the features that are missing data are all categorical features except for <code class="docutils literal notranslate"><span class="pre">'GarageYrBlt'</span></code> which is for when the garage was built. However, if there is no garage then there will obviously be no year for when the garage was built.</p>
<p>First I want to make sure that where there is missing data the numerical values make sense.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;GarageType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;garage&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
GarageType  GarageYrBlt  GarageFinish  GarageCars  GarageArea  GarageQual  GarageCond
NaN         NaN          NaN           0           0           NaN         NaN           81
Name: count, dtype: int64
</pre></div></div>
</div>
<p>And clearly we see that when the categorical data is missing a value the numerical value for <code class="docutils literal notranslate"><span class="pre">'GarageCars'</span></code> and <code class="docutils literal notranslate"><span class="pre">'GarageArea'</span></code> is 0. For the categorical data this is a simple replacement and we will replace all <code class="docutils literal notranslate"><span class="pre">Nan</span></code> with <code class="docutils literal notranslate"><span class="pre">'None'</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GarageType&#39;</span><span class="p">,</span> <span class="s1">&#39;GarageFinish&#39;</span><span class="p">,</span> <span class="s1">&#39;GarageQual&#39;</span><span class="p">,</span> <span class="s1">&#39;GarageCond&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="n">cat_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cat_cols</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">'GarageYrBlt'</span></code> we do not have a nice and neat value that we can asign that makes complete sense. In a way we can set the value to 0 and force it to be an outlier. It can become an interesting thought experiment to try to reason what can happen to the model when do this as opposed to setting the value to some kind of mean based on where the house is located. Could it be that by setting the values to 0 will it affect the correlation between the sale price and the year the garage was built
or if there is a garage at all.</p>
<p>Lets look at that really quick. Here is the correlation between sale price and garage year before replacing the missing values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">,</span> <span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.4867053251422345
</pre></div></div>
</div>
<p>And if we replace the missing values with 0.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_tmp</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">,</span> <span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.2613300869851237
</pre></div></div>
</div>
<p>And if we replace the missing values with 100.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">df_tmp</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">,</span> <span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.26261306587279576
</pre></div></div>
</div>
<p>And if we replace the missing values with 1000.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">df_tmp</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">,</span> <span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.28550228706456937
</pre></div></div>
</div>
<p>And if we replace the missing values with 1900.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">1900</span><span class="p">)</span>
<span class="n">df_tmp</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">,</span> <span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.5185149371069989
</pre></div></div>
</div>
<p>And if we were to replace the missing values with some average with respect to the neighborhood.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">)[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
<span class="n">df_tmp</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">,</span> <span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.5000940244955719
</pre></div></div>
</div>
<p>I believe this is actually a peculiar problem that requires some careful consideration. We cant just make the year a garage was built to be the average when it does not exist and is it also good to create these outliers in the data set? Well, yes actually, because it can be said that the absence of a garage is actually having a very small effect on the sale price owing to a small correlation value between them. It will be interesting to actually create a few models to see the actual effect on
the final results.</p>
<p>For now lets just set them to 0.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;GarageYrBlt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PoolQC</th>
      <td>1451</td>
      <td>99.588195</td>
    </tr>
    <tr>
      <th>MiscFeature</th>
      <td>1403</td>
      <td>96.293754</td>
    </tr>
    <tr>
      <th>Alley</th>
      <td>1366</td>
      <td>93.754290</td>
    </tr>
    <tr>
      <th>Fence</th>
      <td>1176</td>
      <td>80.713795</td>
    </tr>
    <tr>
      <th>FireplaceQu</th>
      <td>690</td>
      <td>47.357584</td>
    </tr>
    <tr>
      <th>LotFrontage</th>
      <td>259</td>
      <td>17.776253</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>And we no longer have any values pertaining to the garage.</p>
</section>
<section id="Pool-quality,-Alley,-Fence,-Misc-Feature">
<h2>Pool quality, Alley, Fence, Misc Feature<a class="headerlink" href="#Pool-quality,-Alley,-Fence,-Misc-Feature" title="Link to this heading">#</a></h2>
<p>Lets quickly take care of the pool quality, alley, and fence values as we already know they should be <code class="docutils literal notranslate"><span class="pre">'None'</span></code> when there are missing values. As alwys I just like to be careful where I can and cross check with data that is related in the data set already. This can only be done for the <code class="docutils literal notranslate"><span class="pre">'PoolQC'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'MiscFeature'</span></code> data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;PoolQC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;PoolArea&#39;</span><span class="p">,</span> <span class="s1">&#39;PoolQC&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PoolArea  PoolQC
0         NaN       1451
Name: count, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MiscFeature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;MiscVal&#39;</span><span class="p">,</span> <span class="s1">&#39;MiscFeature&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MiscVal  MiscFeature
0        NaN            1403
Name: count, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FireplaceQu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;Fireplaces&#39;</span><span class="p">,</span> <span class="s1">&#39;FireplaceQu&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Fireplaces  FireplaceQu
0           NaN            690
Name: count, dtype: int64
</pre></div></div>
</div>
<p>And now that we have confirmed that when <code class="docutils literal notranslate"><span class="pre">'PoolQC'</span></code> is missing a value the value for <code class="docutils literal notranslate"><span class="pre">'PoolArea'</span></code> is 0, we make the replacement.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PoolQC&#39;</span><span class="p">,</span> <span class="s1">&#39;Alley&#39;</span><span class="p">,</span> <span class="s1">&#39;Fence&#39;</span><span class="p">,</span> <span class="s1">&#39;MiscFeature&#39;</span><span class="p">,</span> <span class="s1">&#39;FireplaceQu&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="n">cat_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cat_cols</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>LotFrontage</th>
      <td>259</td>
      <td>17.776253</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Lot-Frontage">
<h2>Lot Frontage<a class="headerlink" href="#Lot-Frontage" title="Link to this heading">#</a></h2>
<p>And we are left with dealing with missing values for the lot frontage. Here is the description for the feature.</p>
<pre>
LotFrontage: Linear feet of street connected to property
</pre><p>For this value we will have to go through different values and make an attempt to guess based on other values. So lets first look at the correlation metrics as this will be a good starting point to see what values are connected.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
LotFrontage     1.000000
1stFlrSF        0.406596
LotArea         0.388597
SalePrice       0.370210
GrLivArea       0.355398
TotRmsAbvGrd    0.336123
TotalBsmtSF     0.323647
GarageArea      0.322424
Name: LotFrontage, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Lot Frontage / ft&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Lot Frontage / ft&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_128_1.png" src="../_images/linear-regression_ames-housing-data_128_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MSSubClass&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Lot Frontage / ft&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Lot Frontage / ft&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_129_1.png" src="../_images/linear-regression_ames-housing-data_129_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;LotConfig&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Lot Frontage / ft&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Lot Frontage / ft&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_130_1.png" src="../_images/linear-regression_ames-housing-data_130_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;LotShape&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Lot Frontage / ft&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Lot Frontage / ft&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_131_1.png" src="../_images/linear-regression_ames-housing-data_131_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;LandContour&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Lot Frontage / ft&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Lot Frontage / ft&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_132_1.png" src="../_images/linear-regression_ames-housing-data_132_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;LandSlope&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Lot Frontage / ft&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Lot Frontage / ft&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_133_1.png" src="../_images/linear-regression_ames-housing-data_133_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;1stFlrSF&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;LotFrontage&#39;, ylabel=&#39;1stFlrSF&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_134_1.png" src="../_images/linear-regression_ames-housing-data_134_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotArea&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;LotFrontage&#39;, ylabel=&#39;LotArea&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_135_1.png" src="../_images/linear-regression_ames-housing-data_135_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LotArea&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">200e3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>Alley</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>LotConfig</th>
      <th>...</th>
      <th>PoolArea</th>
      <th>PoolQC</th>
      <th>Fence</th>
      <th>MiscFeature</th>
      <th>MiscVal</th>
      <th>MoSold</th>
      <th>YrSold</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
      <th>SalePrice</th>
    </tr>
    <tr>
      <th>Id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>314</th>
      <td>20</td>
      <td>RL</td>
      <td>150.0</td>
      <td>215245</td>
      <td>Pave</td>
      <td>None</td>
      <td>IR3</td>
      <td>Low</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0</td>
      <td>6</td>
      <td>2009</td>
      <td>WD</td>
      <td>Normal</td>
      <td>375000</td>
    </tr>
  </tbody>
</table>
<p>1 rows  80 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>Alley</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>LotConfig</th>
      <th>...</th>
      <th>PoolArea</th>
      <th>PoolQC</th>
      <th>Fence</th>
      <th>MiscFeature</th>
      <th>MiscVal</th>
      <th>MoSold</th>
      <th>YrSold</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
      <th>SalePrice</th>
    </tr>
    <tr>
      <th>Id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>935</th>
      <td>20</td>
      <td>RL</td>
      <td>313.0</td>
      <td>27650</td>
      <td>Pave</td>
      <td>None</td>
      <td>IR2</td>
      <td>HLS</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0</td>
      <td>11</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>242000</td>
    </tr>
  </tbody>
</table>
<p>1 rows  80 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;LotFrontage&#39;, ylabel=&#39;SalePrice&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_138_1.png" src="../_images/linear-regression_ames-housing-data_138_1.png" />
</div>
</div>
<p>So what do we see from all these plots?</p>
<p>Well the first one comparing the distribution of lot frontage values as a function of the neighborhood does not show a lot of variation between the values. In some neighborhoods the distribution seems to be smaller, in others there are less points that fall outside of the <span class="math notranslate nohighlight">\(1.5\times \text{IQR}\)</span> limits set by Seaborn in the box plots. Same applies to the next plot with dwelling types, <code class="docutils literal notranslate"><span class="pre">'MSSubClass'</span></code>. Its not until we get to comparing the values of lot area and lot frontage that we get a
good linear trend between the two values with exception of two outliers.</p>
<p>Based on this I will use a linear interpolation to fill in the missing values for the <code class="docutils literal notranslate"><span class="pre">'LotFrontage'</span></code> column.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LotArea&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">200e3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">)][[</span><span class="s1">&#39;LotArea&#39;</span><span class="p">,</span> <span class="s1">&#39;LotFrontage&#39;</span><span class="p">]]</span>
<span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;LotArea&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ydata</span><span class="o">=</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Before we make the replacement lets take a look at how the line fit looks.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;LotArea&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tmp</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">70e3</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x1c879d69650&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_142_1.png" src="../_images/linear-regression_ames-housing-data_142_1.png" />
</div>
</div>
<p>Thats a pretty terrible fit. Due to this issue we will have to use another method to impute the values.</p>
<p>Based on the previous plots we see that there is a small dependence on the lot frontage values on which neighborhood we are in. So lets take a look at the averages that we can get only from the neighborhoods and try to mix it up invloving the type of dwelling <code class="docutils literal notranslate"><span class="pre">'MSSubClass'</span></code>, lot configuration <code class="docutils literal notranslate"><span class="pre">'LotConfig'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'LotShape'</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;SalePrice&#39;, ylabel=&#39;LotFrontage&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_144_1.png" src="../_images/linear-regression_ames-housing-data_144_1.png" />
</div>
</div>
<p>Group by the <code class="docutils literal notranslate"><span class="pre">'Neighborhood'</span></code> column and transform missing values (orange markers) with the average or median.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_lotfront_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Neighborhood&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Missing values after average: 0
Missing values after median: 0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_146_1.png" src="../_images/linear-regression_ames-housing-data_146_1.png" />
</div>
</div>
<p>Group by the <code class="docutils literal notranslate"><span class="pre">'Neighborhood'</span></code>, <code class="docutils literal notranslate"><span class="pre">'MSSubClass'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'MSZoning'</span></code> columns and transform missing values (orange markers) with the average or median.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[86]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_lotfront_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">,</span> <span class="s1">&#39;MSSubClass&#39;</span><span class="p">,</span> <span class="s1">&#39;MSZoning&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Missing values after average: 11
Missing values after median: 11
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_148_1.png" src="../_images/linear-regression_ames-housing-data_148_1.png" />
</div>
</div>
<p>Group by the <code class="docutils literal notranslate"><span class="pre">'LontConfig'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'LotShape'</span></code> columns and transform missing values (orange markers) with the average or median.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_lotfront_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;LotConfig&#39;</span><span class="p">,</span> <span class="s1">&#39;LotShape&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Missing values after average: 1
Missing values after median: 1
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_150_1.png" src="../_images/linear-regression_ames-housing-data_150_1.png" />
</div>
</div>
<p>Group by the <code class="docutils literal notranslate"><span class="pre">'Neighborhood'</span></code>, <code class="docutils literal notranslate"><span class="pre">'LontConfig'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'LotShape'</span></code> columns and transform missing values (orange markers) with the average or median.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[88]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_lotfront_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;LotConfig&#39;</span><span class="p">,</span> <span class="s1">&#39;LotShape&#39;</span><span class="p">,</span> <span class="s1">&#39;Neighborhood&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Missing values after average: 33
Missing values after median: 33
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_152_1.png" src="../_images/linear-regression_ames-housing-data_152_1.png" />
</div>
</div>
<p>Group by the <code class="docutils literal notranslate"><span class="pre">'LandContour'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'LotShape'</span></code> columns and transform missing values (orange markers) with the average or median.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[89]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_lotfront_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;LandContour&#39;</span><span class="p">,</span> <span class="s1">&#39;LotShape&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Missing values after average: 0
Missing values after median: 0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_154_1.png" src="../_images/linear-regression_ames-housing-data_154_1.png" />
</div>
</div>
<p>Group by the <code class="docutils literal notranslate"><span class="pre">'Neighborhood'</span></code>, <code class="docutils literal notranslate"><span class="pre">'LandContour'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'LotShape'</span></code> columns and transform missing values (orange markers) with the average or median.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[90]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_lotfront_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;LandContour&#39;</span><span class="p">,</span> <span class="s1">&#39;LotShape&#39;</span><span class="p">,</span> <span class="s1">&#39;Neighborhood&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Missing values after average: 21
Missing values after median: 21
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_156_1.png" src="../_images/linear-regression_ames-housing-data_156_1.png" />
</div>
</div>
<p>It seems that for most of the combinations that we tried for how to group the values, having the <code class="docutils literal notranslate"><span class="pre">'Neighborhood'</span></code> column in the group seemed to keep the resulting values fairly consistent as shown by the orange markers. We see that they are spread out throughout the entire middle section with most of the other data points.</p>
<p>So the question remains, <em>which is the best method?</em> Just transforming the missing values in the data set with the average for each neighborhood seems to behave well enough as we have seen that there is a small dependence on the lot frontage and the neighborhood. However, I would argue that the shape and the configuration of the lot are equally as important. We can see in the box plots that the distribution of lot frontage values with respect to the lot configuration (<code class="docutils literal notranslate"><span class="pre">'LotConfig'</span></code>) and lot
shape (<code class="docutils literal notranslate"><span class="pre">'LotShape'</span></code>) does vary from one to the other. The <code class="docutils literal notranslate"><span class="pre">'IR3'</span></code> values in <code class="docutils literal notranslate"><span class="pre">'LotShape'</span></code> have a very wide distribution and it makes sense to separate those values from the rest as it can affect the average that is calculated.</p>
<p>As always this is mainly just an educated guess on what is the best method to deal with the missing numerical values. I believe that this method tries to take many different parameters that can affect the lot frontage value and gives a more realistic value. You will always have outliers, but I think this is the best that we can some up with.</p>
<p>So I will make the replacement of the missing values with a transformed average after grouping by <code class="docutils literal notranslate"><span class="pre">'Neighborhood'</span></code>, <code class="docutils literal notranslate"><span class="pre">'LotConfig'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'LotShape'</span></code>. But, there is one <strong>big</strong> issue with this. There are still missing values in the <code class="docutils literal notranslate"><span class="pre">'LotFrontage'</span></code> column meaning that there are not enough data points in the groups to calculate the average this way. Seeing as grouping by just the <code class="docutils literal notranslate"><span class="pre">'Neighborhood'</span></code> fills in all the missing values, I will just group by the <code class="docutils literal notranslate"><span class="pre">'Neighborhood'</span></code> column and fill
in the calculated average.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[91]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Neighborhood&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group_cols</span><span class="p">)[</span><span class="s1">&#39;LotFrontage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[92]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[92]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div>
</div>
<p>And we are done replacing all of the missing values in the data set and can start to actually use it for predictions!!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[93]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_objs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
<span class="n">df_nums</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[94]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_objs</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 1457 entries, 1 to 1460
Data columns (total 44 columns):
 #   Column         Non-Null Count  Dtype
---  ------         --------------  -----
 0   MSSubClass     1457 non-null   object
 1   MSZoning       1457 non-null   object
 2   Street         1457 non-null   object
 3   Alley          1457 non-null   object
 4   LotShape       1457 non-null   object
 5   LandContour    1457 non-null   object
 6   Utilities      1457 non-null   object
 7   LotConfig      1457 non-null   object
 8   LandSlope      1457 non-null   object
 9   Neighborhood   1457 non-null   object
 10  Condition1     1457 non-null   object
 11  Condition2     1457 non-null   object
 12  BldgType       1457 non-null   object
 13  HouseStyle     1457 non-null   object
 14  RoofStyle      1457 non-null   object
 15  RoofMatl       1457 non-null   object
 16  Exterior1st    1457 non-null   object
 17  Exterior2nd    1457 non-null   object
 18  MasVnrType     1457 non-null   object
 19  ExterQual      1457 non-null   object
 20  ExterCond      1457 non-null   object
 21  Foundation     1457 non-null   object
 22  BsmtQual       1457 non-null   object
 23  BsmtCond       1457 non-null   object
 24  BsmtExposure   1457 non-null   object
 25  BsmtFinType1   1457 non-null   object
 26  BsmtFinType2   1457 non-null   object
 27  Heating        1457 non-null   object
 28  HeatingQC      1457 non-null   object
 29  CentralAir     1457 non-null   object
 30  Electrical     1457 non-null   object
 31  KitchenQual    1457 non-null   object
 32  Functional     1457 non-null   object
 33  FireplaceQu    1457 non-null   object
 34  GarageType     1457 non-null   object
 35  GarageFinish   1457 non-null   object
 36  GarageQual     1457 non-null   object
 37  GarageCond     1457 non-null   object
 38  PavedDrive     1457 non-null   object
 39  PoolQC         1457 non-null   object
 40  Fence          1457 non-null   object
 41  MiscFeature    1457 non-null   object
 42  SaleType       1457 non-null   object
 43  SaleCondition  1457 non-null   object
dtypes: object(44)
memory usage: 512.2+ KB
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[95]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_nums</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 1457 entries, 1 to 1460
Data columns (total 36 columns):
 #   Column         Non-Null Count  Dtype
---  ------         --------------  -----
 0   LotFrontage    1457 non-null   float64
 1   LotArea        1457 non-null   int64
 2   OverallQual    1457 non-null   int64
 3   OverallCond    1457 non-null   int64
 4   YearBuilt      1457 non-null   int64
 5   YearRemodAdd   1457 non-null   int64
 6   MasVnrArea     1457 non-null   float64
 7   BsmtFinSF1     1457 non-null   int64
 8   BsmtFinSF2     1457 non-null   int64
 9   BsmtUnfSF      1457 non-null   int64
 10  TotalBsmtSF    1457 non-null   int64
 11  1stFlrSF       1457 non-null   int64
 12  2ndFlrSF       1457 non-null   int64
 13  LowQualFinSF   1457 non-null   int64
 14  GrLivArea      1457 non-null   int64
 15  BsmtFullBath   1457 non-null   int64
 16  BsmtHalfBath   1457 non-null   int64
 17  FullBath       1457 non-null   int64
 18  HalfBath       1457 non-null   int64
 19  BedroomAbvGr   1457 non-null   int64
 20  KitchenAbvGr   1457 non-null   int64
 21  TotRmsAbvGrd   1457 non-null   int64
 22  Fireplaces     1457 non-null   int64
 23  GarageYrBlt    1457 non-null   float64
 24  GarageCars     1457 non-null   int64
 25  GarageArea     1457 non-null   int64
 26  WoodDeckSF     1457 non-null   int64
 27  OpenPorchSF    1457 non-null   int64
 28  EnclosedPorch  1457 non-null   int64
 29  3SsnPorch      1457 non-null   int64
 30  ScreenPorch    1457 non-null   int64
 31  PoolArea       1457 non-null   int64
 32  MiscVal        1457 non-null   int64
 33  MoSold         1457 non-null   int64
 34  YrSold         1457 non-null   int64
 35  SalePrice      1457 non-null   int64
dtypes: float64(3), int64(33)
memory usage: 421.2 KB
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[96]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_objs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_objs</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Save-the-final-data-set-after-processing">
<h2>Save the final data set after processing<a class="headerlink" href="#Save-the-final-data-set-after-processing" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[97]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_nums</span><span class="p">,</span> <span class="n">df_objs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[98]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;_data&#39;</span><span class="p">,</span> <span class="s1">&#39;ames-data-no-missing.csv&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Linear-Regression">
<h1>Linear Regression<a class="headerlink" href="#Linear-Regression" title="Link to this heading">#</a></h1>
<section id="Import-linear-regression-libraries">
<h2>Import linear regression libraries<a class="headerlink" href="#Import-linear-regression-libraries" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[99]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">RidgeCV</span><span class="p">,</span> <span class="n">LassoCV</span><span class="p">,</span> <span class="n">ElasticNetCV</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[100]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert_strings</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">base</span><span class="p">):</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">num</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="n">base</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">base</span><span class="o">-</span><span class="mi">2</span><span class="p">)))[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">length</span> <span class="o">==</span> <span class="n">base</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">base</span><span class="o">-</span><span class="mi">2</span><span class="p">)))[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The length of the number to round is larger&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">E+</span><span class="si">{:02d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">base</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">gen_comp_plot</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">avg</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">text_tmp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">text_tmp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">text_tmp</span> <span class="o">=</span> <span class="n">error_text</span>
    <span class="n">base</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">avg_price</span><span class="p">)))</span>
    <span class="n">str_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">convert_strings</span><span class="p">(</span><span class="n">avg</span><span class="p">,</span> <span class="n">base</span><span class="p">),</span>
                <span class="n">convert_strings</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">],</span> <span class="n">base</span><span class="p">),</span>
                <span class="n">convert_strings</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;MedAE&#39;</span><span class="p">],</span> <span class="n">base</span><span class="p">),</span>
                <span class="n">convert_strings</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">],</span> <span class="n">base</span><span class="p">),</span>
                <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]]</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">pred</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">replace_price_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;Actual sale price&#39;</span><span class="p">)</span>
    <span class="n">replace_price_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;Predicted sale price&#39;</span><span class="p">)</span>
    <span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">xlim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="n">new_lim</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">new_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">new_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">new_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">new_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">new_lim</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">new_lim</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">new_lim</span><span class="p">,</span> <span class="n">new_lim</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">text_tmp</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">str_vals</span><span class="p">),</span>
            <span class="n">x</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.97</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[101]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span><span class="se">\</span>
<span class="s1">- Average sale price: </span><span class="si">{}</span>
<span class="s1">- Mean absolute error: </span><span class="si">{}</span>
<span class="s1">- Median absolute error: </span><span class="si">{}</span>
<span class="s1">- Root mean squared error: </span><span class="si">{}</span>
<span class="s1">- R Squared: </span><span class="si">{:.4f}</span><span class="se">\</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">errors</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">test_preds</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
</div>
</section>
<section id="Data-manipulation">
<h2>Data manipulation<a class="headerlink" href="#Data-manipulation" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[102]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dtypes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MSSubClass</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;_data&#39;</span><span class="p">,</span> <span class="s1">&#39;ames-data-no-missing.csv&#39;</span><span class="p">),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[103]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[103]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([], dtype=int64),)
</pre></div></div>
</div>
<section id="Make-a-train-test-split">
<h3>Make a train test split<a class="headerlink" href="#Make-a-train-test-split" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[104]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[105]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">avg_price</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Scale-the-data">
<h3>Scale the data<a class="headerlink" href="#Scale-the-data" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[106]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Ordinary-least-squares">
<h2>Ordinary least squares<a class="headerlink" href="#Ordinary-least-squares" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[107]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[108]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">models</span><span class="p">[</span><span class="s1">&#39;ols&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[109]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_predictions</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="s1">&#39;ols&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MSE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MedAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;ols&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_predictions</span>
<span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ols&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MAE</span><span class="o">=</span><span class="n">MAE</span><span class="p">,</span> <span class="n">MSE</span><span class="o">=</span><span class="n">MSE</span><span class="p">,</span> <span class="n">RMSE</span><span class="o">=</span><span class="n">RMSE</span><span class="p">,</span>
                    <span class="n">MedAE</span><span class="o">=</span><span class="n">MedAE</span><span class="p">,</span> <span class="n">r2</span><span class="o">=</span><span class="n">r2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Plotting-real-vs.-predicted-values">
<h3>Plotting real vs. predicted values<a class="headerlink" href="#Plotting-real-vs.-predicted-values" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[110]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">gen_comp_plot</span><span class="p">(</span><span class="s1">&#39;Ordinary Least Squares&#39;</span><span class="p">,</span> <span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;ols&#39;</span><span class="p">],</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span>
              <span class="n">avg_price</span><span class="p">,</span> <span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ols&#39;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_186_0.png" src="../_images/linear-regression_ames-housing-data_186_0.png" />
</div>
</div>
</section>
</section>
<section id="Ridge-Regression">
<h2>Ridge Regression<a class="headerlink" href="#Ridge-Regression" title="Link to this heading">#</a></h2>
<p>Now I will use the scaled training data and train the models using the <code class="docutils literal notranslate"><span class="pre">RidgeCV</span></code> model in the <code class="docutils literal notranslate"><span class="pre">linear_regression</span></code> module in scikit-learn. This will let me more easily tune the hyper-parameter, <span class="math notranslate nohighlight">\(\alpha\)</span>, rather than running a grid search. The reason I am doing this is that <code class="docutils literal notranslate"><span class="pre">RidgeCV</span></code> will use a scoring function to determine the best hyper-parameter. This is more of a curiosity of mine to see how the scoring actually affects the final results from training the model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[111]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
</div>
<section id="Mean-Absolute-Error">
<h3>Mean Absolute Error<a class="headerlink" href="#Mean-Absolute-Error" title="Link to this heading">#</a></h3>
<p>Here we use the mean absolute error as the scoring metric in the training step.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[112]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_absolute_error&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[113]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[113]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RidgeCV(alphas=array([350.  , 350.05, 350.1 , 350.15, 350.2 , 350.25, 350.3 , 350.35,
       350.4 , 350.45, 350.5 , 350.55, 350.6 , 350.65, 350.7 , 350.75,
       350.8 , 350.85, 350.9 , 350.95, 351.  , 351.05, 351.1 , 351.15,
       351.2 , 351.25, 351.3 , 351.35, 351.4 , 351.45, 351.5 , 351.55,
       351.6 , 351.65, 351.7 , 351.75, 351.8 , 351.85, 351.9 , 351.95,
       352.  , 352.05, 352.1 , 352.15, 352.2 , 352.25, 352.3 , 352.35,
       352.4 , 352.45, 352.5 ,...
       357.2 , 357.25, 357.3 , 357.35, 357.4 , 357.45, 357.5 , 357.55,
       357.6 , 357.65, 357.7 , 357.75, 357.8 , 357.85, 357.9 , 357.95,
       358.  , 358.05, 358.1 , 358.15, 358.2 , 358.25, 358.3 , 358.35,
       358.4 , 358.45, 358.5 , 358.55, 358.6 , 358.65, 358.7 , 358.75,
       358.8 , 358.85, 358.9 , 358.95, 359.  , 359.05, 359.1 , 359.15,
       359.2 , 359.25, 359.3 , 359.35, 359.4 , 359.45, 359.5 , 359.55,
       359.6 , 359.65, 359.7 , 359.75, 359.8 , 359.85, 359.9 , 359.95]),
        scoring=&#x27;neg_mean_absolute_error&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">RidgeCV</label><div class="sk-toggleable__content"><pre>RidgeCV(alphas=array([350.  , 350.05, 350.1 , 350.15, 350.2 , 350.25, 350.3 , 350.35,
       350.4 , 350.45, 350.5 , 350.55, 350.6 , 350.65, 350.7 , 350.75,
       350.8 , 350.85, 350.9 , 350.95, 351.  , 351.05, 351.1 , 351.15,
       351.2 , 351.25, 351.3 , 351.35, 351.4 , 351.45, 351.5 , 351.55,
       351.6 , 351.65, 351.7 , 351.75, 351.8 , 351.85, 351.9 , 351.95,
       352.  , 352.05, 352.1 , 352.15, 352.2 , 352.25, 352.3 , 352.35,
       352.4 , 352.45, 352.5 ,...
       357.2 , 357.25, 357.3 , 357.35, 357.4 , 357.45, 357.5 , 357.55,
       357.6 , 357.65, 357.7 , 357.75, 357.8 , 357.85, 357.9 , 357.95,
       358.  , 358.05, 358.1 , 358.15, 358.2 , 358.25, 358.3 , 358.35,
       358.4 , 358.45, 358.5 , 358.55, 358.6 , 358.65, 358.7 , 358.75,
       358.8 , 358.85, 358.9 , 358.95, 359.  , 359.05, 359.1 , 359.15,
       359.2 , 359.25, 359.3 , 359.35, 359.4 , 359.45, 359.5 , 359.55,
       359.6 , 359.65, 359.7 , 359.75, 359.8 , 359.85, 359.9 , 359.95]),
        scoring=&#x27;neg_mean_absolute_error&#x27;)</pre></div></div></div></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[114]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MAE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
<span class="n">alphas</span><span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
<span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[114]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
354.500000000001
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[115]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_predictions</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MAE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MSE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MedAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MAPerE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MAE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MAE</span><span class="o">=</span><span class="n">MAE</span><span class="p">,</span> <span class="n">MSE</span><span class="o">=</span><span class="n">MSE</span><span class="p">,</span> <span class="n">RMSE</span><span class="o">=</span><span class="n">RMSE</span><span class="p">,</span>
                       <span class="n">r2</span><span class="o">=</span><span class="n">r2</span><span class="p">,</span> <span class="n">MedAE</span><span class="o">=</span><span class="n">MedAE</span><span class="p">,</span> <span class="n">MAPerE</span><span class="o">=</span><span class="n">MAPerE</span><span class="p">)</span>
<span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MAE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_predictions</span>
</pre></div>
</div>
</div>
</section>
<section id="Mean-Squared-Error-or-Root-Mean-Squared-Error">
<h3>Mean Squared Error or Root Mean Squared Error<a class="headerlink" href="#Mean-Squared-Error-or-Root-Mean-Squared-Error" title="Link to this heading">#</a></h3>
<p>Here we use the mean squared error as the scoring metric in the training step. According to the documentation on scikit-learn, if you want to use the root mean squared error as the scoring metric you end up just using mean squared error. Which makes sense honestly.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[116]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">185</span><span class="p">,</span> <span class="mi">195</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_squared_error&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[117]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[117]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RidgeCV(alphas=array([185.  , 185.05, 185.1 , 185.15, 185.2 , 185.25, 185.3 , 185.35,
       185.4 , 185.45, 185.5 , 185.55, 185.6 , 185.65, 185.7 , 185.75,
       185.8 , 185.85, 185.9 , 185.95, 186.  , 186.05, 186.1 , 186.15,
       186.2 , 186.25, 186.3 , 186.35, 186.4 , 186.45, 186.5 , 186.55,
       186.6 , 186.65, 186.7 , 186.75, 186.8 , 186.85, 186.9 , 186.95,
       187.  , 187.05, 187.1 , 187.15, 187.2 , 187.25, 187.3 , 187.35,
       187.4 , 187.45, 187.5 ,...
       192.2 , 192.25, 192.3 , 192.35, 192.4 , 192.45, 192.5 , 192.55,
       192.6 , 192.65, 192.7 , 192.75, 192.8 , 192.85, 192.9 , 192.95,
       193.  , 193.05, 193.1 , 193.15, 193.2 , 193.25, 193.3 , 193.35,
       193.4 , 193.45, 193.5 , 193.55, 193.6 , 193.65, 193.7 , 193.75,
       193.8 , 193.85, 193.9 , 193.95, 194.  , 194.05, 194.1 , 194.15,
       194.2 , 194.25, 194.3 , 194.35, 194.4 , 194.45, 194.5 , 194.55,
       194.6 , 194.65, 194.7 , 194.75, 194.8 , 194.85, 194.9 , 194.95]),
        scoring=&#x27;neg_mean_squared_error&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">RidgeCV</label><div class="sk-toggleable__content"><pre>RidgeCV(alphas=array([185.  , 185.05, 185.1 , 185.15, 185.2 , 185.25, 185.3 , 185.35,
       185.4 , 185.45, 185.5 , 185.55, 185.6 , 185.65, 185.7 , 185.75,
       185.8 , 185.85, 185.9 , 185.95, 186.  , 186.05, 186.1 , 186.15,
       186.2 , 186.25, 186.3 , 186.35, 186.4 , 186.45, 186.5 , 186.55,
       186.6 , 186.65, 186.7 , 186.75, 186.8 , 186.85, 186.9 , 186.95,
       187.  , 187.05, 187.1 , 187.15, 187.2 , 187.25, 187.3 , 187.35,
       187.4 , 187.45, 187.5 ,...
       192.2 , 192.25, 192.3 , 192.35, 192.4 , 192.45, 192.5 , 192.55,
       192.6 , 192.65, 192.7 , 192.75, 192.8 , 192.85, 192.9 , 192.95,
       193.  , 193.05, 193.1 , 193.15, 193.2 , 193.25, 193.3 , 193.35,
       193.4 , 193.45, 193.5 , 193.55, 193.6 , 193.65, 193.7 , 193.75,
       193.8 , 193.85, 193.9 , 193.95, 194.  , 194.05, 194.1 , 194.15,
       194.2 , 194.25, 194.3 , 194.35, 194.4 , 194.45, 194.5 , 194.55,
       194.6 , 194.65, 194.7 , 194.75, 194.8 , 194.85, 194.9 , 194.95]),
        scoring=&#x27;neg_mean_squared_error&#x27;)</pre></div></div></div></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[118]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MSE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
<span class="n">alphas</span><span class="p">[</span><span class="s1">&#39;MSE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
<span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[118]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
190.15000000000117
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[119]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_predictions</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MSE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MedAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MAPerE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MSE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MAE</span><span class="o">=</span><span class="n">MAE</span><span class="p">,</span> <span class="n">MSE</span><span class="o">=</span><span class="n">MSE</span><span class="p">,</span> <span class="n">RMSE</span><span class="o">=</span><span class="n">RMSE</span><span class="p">,</span>
                       <span class="n">r2</span><span class="o">=</span><span class="n">r2</span><span class="p">,</span> <span class="n">MedAE</span><span class="o">=</span><span class="n">MedAE</span><span class="p">,</span> <span class="n">MAPerE</span><span class="o">=</span><span class="n">MAPerE</span><span class="p">)</span>
<span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MAE</span><span class="o">=</span><span class="n">MAE</span><span class="p">,</span> <span class="n">MSE</span><span class="o">=</span><span class="n">MSE</span><span class="p">,</span> <span class="n">RMSE</span><span class="o">=</span><span class="n">RMSE</span><span class="p">,</span>
                       <span class="n">r2</span><span class="o">=</span><span class="n">r2</span><span class="p">,</span> <span class="n">MedAE</span><span class="o">=</span><span class="n">MedAE</span><span class="p">,</span> <span class="n">MAPerE</span><span class="o">=</span><span class="n">MAPerE</span><span class="p">)</span>
<span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MSE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_predictions</span>
</pre></div>
</div>
</div>
</section>
<section id="R-Squared-(coefficient-of-determination)">
<h3>R Squared (coefficient of determination)<a class="headerlink" href="#R-Squared-(coefficient-of-determination)" title="Link to this heading">#</a></h3>
<p>Here we use R squared as the scoring metric in the training step.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[120]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">185</span><span class="p">,</span> <span class="mi">195</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[121]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[121]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>#sk-container-id-3 {color: black;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RidgeCV(alphas=array([185.  , 185.05, 185.1 , 185.15, 185.2 , 185.25, 185.3 , 185.35,
       185.4 , 185.45, 185.5 , 185.55, 185.6 , 185.65, 185.7 , 185.75,
       185.8 , 185.85, 185.9 , 185.95, 186.  , 186.05, 186.1 , 186.15,
       186.2 , 186.25, 186.3 , 186.35, 186.4 , 186.45, 186.5 , 186.55,
       186.6 , 186.65, 186.7 , 186.75, 186.8 , 186.85, 186.9 , 186.95,
       187.  , 187.05, 187.1 , 187.15, 187.2 , 187.25, 187.3 , 187.35,
       187.4 , 187.45, 187.5 ,...
       192.2 , 192.25, 192.3 , 192.35, 192.4 , 192.45, 192.5 , 192.55,
       192.6 , 192.65, 192.7 , 192.75, 192.8 , 192.85, 192.9 , 192.95,
       193.  , 193.05, 193.1 , 193.15, 193.2 , 193.25, 193.3 , 193.35,
       193.4 , 193.45, 193.5 , 193.55, 193.6 , 193.65, 193.7 , 193.75,
       193.8 , 193.85, 193.9 , 193.95, 194.  , 194.05, 194.1 , 194.15,
       194.2 , 194.25, 194.3 , 194.35, 194.4 , 194.45, 194.5 , 194.55,
       194.6 , 194.65, 194.7 , 194.75, 194.8 , 194.85, 194.9 , 194.95]),
        scoring=&#x27;r2&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" checked><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">RidgeCV</label><div class="sk-toggleable__content"><pre>RidgeCV(alphas=array([185.  , 185.05, 185.1 , 185.15, 185.2 , 185.25, 185.3 , 185.35,
       185.4 , 185.45, 185.5 , 185.55, 185.6 , 185.65, 185.7 , 185.75,
       185.8 , 185.85, 185.9 , 185.95, 186.  , 186.05, 186.1 , 186.15,
       186.2 , 186.25, 186.3 , 186.35, 186.4 , 186.45, 186.5 , 186.55,
       186.6 , 186.65, 186.7 , 186.75, 186.8 , 186.85, 186.9 , 186.95,
       187.  , 187.05, 187.1 , 187.15, 187.2 , 187.25, 187.3 , 187.35,
       187.4 , 187.45, 187.5 ,...
       192.2 , 192.25, 192.3 , 192.35, 192.4 , 192.45, 192.5 , 192.55,
       192.6 , 192.65, 192.7 , 192.75, 192.8 , 192.85, 192.9 , 192.95,
       193.  , 193.05, 193.1 , 193.15, 193.2 , 193.25, 193.3 , 193.35,
       193.4 , 193.45, 193.5 , 193.55, 193.6 , 193.65, 193.7 , 193.75,
       193.8 , 193.85, 193.9 , 193.95, 194.  , 194.05, 194.1 , 194.15,
       194.2 , 194.25, 194.3 , 194.35, 194.4 , 194.45, 194.5 , 194.55,
       194.6 , 194.65, 194.7 , 194.75, 194.8 , 194.85, 194.9 , 194.95]),
        scoring=&#x27;r2&#x27;)</pre></div></div></div></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[122]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
<span class="n">alphas</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
<span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[122]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
190.15000000000117
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[123]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_predictions</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MSE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MedAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MAPerE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MAE</span><span class="o">=</span><span class="n">MAE</span><span class="p">,</span> <span class="n">MSE</span><span class="o">=</span><span class="n">MSE</span><span class="p">,</span> <span class="n">RMSE</span><span class="o">=</span><span class="n">RMSE</span><span class="p">,</span>
                       <span class="n">r2</span><span class="o">=</span><span class="n">r2</span><span class="p">,</span> <span class="n">MedAE</span><span class="o">=</span><span class="n">MedAE</span><span class="p">,</span> <span class="n">MAPerE</span><span class="o">=</span><span class="n">MAPerE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error_text</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">MAE</span><span class="p">,</span> <span class="n">RMSE</span><span class="p">,</span> <span class="n">MedAE</span><span class="p">,</span> <span class="n">r2</span><span class="p">))</span>
<span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_predictions</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
- Average sale price: 181122.35616438356
- Mean absolute error: 17800.40465778638
- Median absolute error: 26864.900197008257
- Root mean squared error: 12640.520799038932
- R Squared: 0.8909
</pre></div></div>
</div>
</section>
<section id="Median-Absolute-Error">
<h3>Median Absolute Error<a class="headerlink" href="#Median-Absolute-Error" title="Link to this heading">#</a></h3>
<p>Here we use the median absolute error as the scoring metric in the training step.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[124]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">740</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_median_absolute_error&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[125]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[125]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>#sk-container-id-4 {color: black;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RidgeCV(alphas=array([740.  , 740.05, 740.1 , 740.15, 740.2 , 740.25, 740.3 , 740.35,
       740.4 , 740.45, 740.5 , 740.55, 740.6 , 740.65, 740.7 , 740.75,
       740.8 , 740.85, 740.9 , 740.95, 741.  , 741.05, 741.1 , 741.15,
       741.2 , 741.25, 741.3 , 741.35, 741.4 , 741.45, 741.5 , 741.55,
       741.6 , 741.65, 741.7 , 741.75, 741.8 , 741.85, 741.9 , 741.95,
       742.  , 742.05, 742.1 , 742.15, 742.2 , 742.25, 742.3 , 742.35,
       742.4 , 742.45, 742.5 ,...
       747.2 , 747.25, 747.3 , 747.35, 747.4 , 747.45, 747.5 , 747.55,
       747.6 , 747.65, 747.7 , 747.75, 747.8 , 747.85, 747.9 , 747.95,
       748.  , 748.05, 748.1 , 748.15, 748.2 , 748.25, 748.3 , 748.35,
       748.4 , 748.45, 748.5 , 748.55, 748.6 , 748.65, 748.7 , 748.75,
       748.8 , 748.85, 748.9 , 748.95, 749.  , 749.05, 749.1 , 749.15,
       749.2 , 749.25, 749.3 , 749.35, 749.4 , 749.45, 749.5 , 749.55,
       749.6 , 749.65, 749.7 , 749.75, 749.8 , 749.85, 749.9 , 749.95]),
        scoring=&#x27;neg_median_absolute_error&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" checked><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">RidgeCV</label><div class="sk-toggleable__content"><pre>RidgeCV(alphas=array([740.  , 740.05, 740.1 , 740.15, 740.2 , 740.25, 740.3 , 740.35,
       740.4 , 740.45, 740.5 , 740.55, 740.6 , 740.65, 740.7 , 740.75,
       740.8 , 740.85, 740.9 , 740.95, 741.  , 741.05, 741.1 , 741.15,
       741.2 , 741.25, 741.3 , 741.35, 741.4 , 741.45, 741.5 , 741.55,
       741.6 , 741.65, 741.7 , 741.75, 741.8 , 741.85, 741.9 , 741.95,
       742.  , 742.05, 742.1 , 742.15, 742.2 , 742.25, 742.3 , 742.35,
       742.4 , 742.45, 742.5 ,...
       747.2 , 747.25, 747.3 , 747.35, 747.4 , 747.45, 747.5 , 747.55,
       747.6 , 747.65, 747.7 , 747.75, 747.8 , 747.85, 747.9 , 747.95,
       748.  , 748.05, 748.1 , 748.15, 748.2 , 748.25, 748.3 , 748.35,
       748.4 , 748.45, 748.5 , 748.55, 748.6 , 748.65, 748.7 , 748.75,
       748.8 , 748.85, 748.9 , 748.95, 749.  , 749.05, 749.1 , 749.15,
       749.2 , 749.25, 749.3 , 749.35, 749.4 , 749.45, 749.5 , 749.55,
       749.6 , 749.65, 749.7 , 749.75, 749.8 , 749.85, 749.9 , 749.95]),
        scoring=&#x27;neg_median_absolute_error&#x27;)</pre></div></div></div></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[126]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MedAE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
<span class="n">alphas</span><span class="p">[</span><span class="s1">&#39;MedAE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
<span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[126]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
748.799999999992
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[127]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_predictions</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MedAE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MSE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MedAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MAPerE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MedAE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MAE</span><span class="o">=</span><span class="n">MAE</span><span class="p">,</span> <span class="n">MSE</span><span class="o">=</span><span class="n">MSE</span><span class="p">,</span> <span class="n">RMSE</span><span class="o">=</span><span class="n">RMSE</span><span class="p">,</span>
                       <span class="n">r2</span><span class="o">=</span><span class="n">r2</span><span class="p">,</span> <span class="n">MedAE</span><span class="o">=</span><span class="n">MedAE</span><span class="p">,</span> <span class="n">MAPerE</span><span class="o">=</span><span class="n">MAPerE</span><span class="p">)</span>
<span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MedAE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_predictions</span>
</pre></div>
</div>
</div>
</section>
<section id="Mean-Absolute-Percentage-Error">
<h3>Mean Absolute Percentage Error<a class="headerlink" href="#Mean-Absolute-Percentage-Error" title="Link to this heading">#</a></h3>
<p>Here we use the mean absolute percentage error as the scoring metric in the training step.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[128]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1020</span><span class="p">,</span> <span class="mi">1030</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_absolute_percentage_error&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[129]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[129]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>#sk-container-id-5 {color: black;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RidgeCV(alphas=array([1020.  , 1020.05, 1020.1 , 1020.15, 1020.2 , 1020.25, 1020.3 ,
       1020.35, 1020.4 , 1020.45, 1020.5 , 1020.55, 1020.6 , 1020.65,
       1020.7 , 1020.75, 1020.8 , 1020.85, 1020.9 , 1020.95, 1021.  ,
       1021.05, 1021.1 , 1021.15, 1021.2 , 1021.25, 1021.3 , 1021.35,
       1021.4 , 1021.45, 1021.5 , 1021.55, 1021.6 , 1021.65, 1021.7 ,
       1021.75, 1021.8 , 1021.85, 1021.9 , 1021.95, 1022.  , 1022.05,
       1022.1 , 1022.15, 1...
       1027.7 , 1027.75, 1027.8 , 1027.85, 1027.9 , 1027.95, 1028.  ,
       1028.05, 1028.1 , 1028.15, 1028.2 , 1028.25, 1028.3 , 1028.35,
       1028.4 , 1028.45, 1028.5 , 1028.55, 1028.6 , 1028.65, 1028.7 ,
       1028.75, 1028.8 , 1028.85, 1028.9 , 1028.95, 1029.  , 1029.05,
       1029.1 , 1029.15, 1029.2 , 1029.25, 1029.3 , 1029.35, 1029.4 ,
       1029.45, 1029.5 , 1029.55, 1029.6 , 1029.65, 1029.7 , 1029.75,
       1029.8 , 1029.85, 1029.9 , 1029.95]),
        scoring=&#x27;neg_mean_absolute_percentage_error&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" checked><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">RidgeCV</label><div class="sk-toggleable__content"><pre>RidgeCV(alphas=array([1020.  , 1020.05, 1020.1 , 1020.15, 1020.2 , 1020.25, 1020.3 ,
       1020.35, 1020.4 , 1020.45, 1020.5 , 1020.55, 1020.6 , 1020.65,
       1020.7 , 1020.75, 1020.8 , 1020.85, 1020.9 , 1020.95, 1021.  ,
       1021.05, 1021.1 , 1021.15, 1021.2 , 1021.25, 1021.3 , 1021.35,
       1021.4 , 1021.45, 1021.5 , 1021.55, 1021.6 , 1021.65, 1021.7 ,
       1021.75, 1021.8 , 1021.85, 1021.9 , 1021.95, 1022.  , 1022.05,
       1022.1 , 1022.15, 1...
       1027.7 , 1027.75, 1027.8 , 1027.85, 1027.9 , 1027.95, 1028.  ,
       1028.05, 1028.1 , 1028.15, 1028.2 , 1028.25, 1028.3 , 1028.35,
       1028.4 , 1028.45, 1028.5 , 1028.55, 1028.6 , 1028.65, 1028.7 ,
       1028.75, 1028.8 , 1028.85, 1028.9 , 1028.95, 1029.  , 1029.05,
       1029.1 , 1029.15, 1029.2 , 1029.25, 1029.3 , 1029.35, 1029.4 ,
       1029.45, 1029.5 , 1029.55, 1029.6 , 1029.65, 1029.7 , 1029.75,
       1029.8 , 1029.85, 1029.9 , 1029.95]),
        scoring=&#x27;neg_mean_absolute_percentage_error&#x27;)</pre></div></div></div></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[130]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MAPerE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
<span class="n">alphas</span><span class="p">[</span><span class="s1">&#39;MAPerE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
<span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[130]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1024.2499999999961
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[131]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_predictions</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MAPerE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MSE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MedAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MAPerE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MAPerE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MAE</span><span class="o">=</span><span class="n">MAE</span><span class="p">,</span> <span class="n">MSE</span><span class="o">=</span><span class="n">MSE</span><span class="p">,</span> <span class="n">RMSE</span><span class="o">=</span><span class="n">RMSE</span><span class="p">,</span>
                       <span class="n">r2</span><span class="o">=</span><span class="n">r2</span><span class="p">,</span> <span class="n">MedAE</span><span class="o">=</span><span class="n">MedAE</span><span class="p">,</span> <span class="n">MAPerE</span><span class="o">=</span><span class="n">MAPerE</span><span class="p">)</span>
<span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="s1">&#39;MAPerE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_predictions</span>
</pre></div>
</div>
</div>
</section>
<section id="Analyzing-error-metrics">
<h3>Analyzing error metrics<a class="headerlink" href="#Analyzing-error-metrics" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[132]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">ndf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">error_df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="n">alphas</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;alpha&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ndf</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;scoring&#39;</span>
<span class="n">ndf</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;metric&#39;</span>
<span class="n">ndf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[132]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>metric</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>r2</th>
      <th>MedAE</th>
      <th>MAPerE</th>
      <th>alpha</th>
    </tr>
    <tr>
      <th>scoring</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MAE</th>
      <td>17968.776853</td>
      <td>7.523634e+08</td>
      <td>27429.243295</td>
      <td>0.886246</td>
      <td>12030.073612</td>
      <td>0.108136</td>
      <td>354.50</td>
    </tr>
    <tr>
      <th>MSE</th>
      <td>17800.404658</td>
      <td>7.217229e+08</td>
      <td>26864.900197</td>
      <td>0.890878</td>
      <td>12640.520799</td>
      <td>0.108687</td>
      <td>190.15</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>17800.404658</td>
      <td>7.217229e+08</td>
      <td>26864.900197</td>
      <td>0.890878</td>
      <td>12640.520799</td>
      <td>0.108687</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>r2</th>
      <td>17800.404658</td>
      <td>7.217229e+08</td>
      <td>26864.900197</td>
      <td>0.890878</td>
      <td>12640.520799</td>
      <td>0.108687</td>
      <td>190.15</td>
    </tr>
    <tr>
      <th>MedAE</th>
      <td>18385.122105</td>
      <td>8.222842e+08</td>
      <td>28675.498464</td>
      <td>0.875674</td>
      <td>11674.233991</td>
      <td>0.108510</td>
      <td>748.80</td>
    </tr>
    <tr>
      <th>MAPerE</th>
      <td>18686.683333</td>
      <td>8.697449e+08</td>
      <td>29491.437899</td>
      <td>0.868498</td>
      <td>12247.473170</td>
      <td>0.109258</td>
      <td>1024.25</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<section id="Plotting-error-metrics">
<h4>Plotting error metrics<a class="headerlink" href="#Plotting-error-metrics" title="Link to this heading">#</a></h4>
<p>Below is a plot of the error metric values as a function of the scoring metric that we used in the training step.</p>
<p>The acronyms are: - MAE: Mean Absolute Error - MSE: Mean Squared Error - RMSE: Root Mean Squared Error (not exactly using it as a scoring metric when training the model just wanted to make a better comparison to MAE) - r2: R Squared - MedAE: Median Absolute Error - MAPerE: Mean Absolute Percentage Error</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[133]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapper</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MAE</span><span class="o">=</span><span class="s1">&#39;Mean Absolute Error (MAE)&#39;</span><span class="p">,</span> <span class="n">MSE</span><span class="o">=</span><span class="s1">&#39;Mean Squared Error (MSE)&#39;</span><span class="p">,</span>
              <span class="n">RMSE</span><span class="o">=</span><span class="s1">&#39;Root Mean Squared Error (RMSE)&#39;</span><span class="p">,</span> <span class="n">r2</span><span class="o">=</span><span class="s1">&#39;R Squared (r2)&#39;</span><span class="p">,</span>
              <span class="n">MedAE</span><span class="o">=</span><span class="s1">&#39;Median Absolute Error (MedAE)&#39;</span><span class="p">,</span>
              <span class="n">MAPerE</span><span class="o">=</span><span class="s1">&#39;Mean Absolute Percentage Error (MAPerE)&#39;</span><span class="p">)</span>
<span class="c1"># error_df.drop(&#39;MAPerE&#39;, axis=0, inplace=True)</span>
<span class="c1"># error_df.drop(&#39;MAPerE&#39;, axis=1, inplace=True)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">error_df</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">error_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">mapper</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Scoring metric used when training&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_217_0.png" src="../_images/linear-regression_ames-housing-data_217_0.png" />
</div>
</div>
</section>
</section>
<section id="id1">
<h3>Plotting real vs. predicted values<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[134]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">base</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">mean</span><span class="p">())))</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">str_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">convert_strings</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">base</span><span class="p">),</span>
                <span class="n">convert_strings</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;MAE&#39;</span><span class="p">],</span> <span class="n">base</span><span class="p">),</span>
                <span class="n">convert_strings</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;MedAE&#39;</span><span class="p">],</span> <span class="n">base</span><span class="p">),</span>
                <span class="n">convert_strings</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;RMSE&#39;</span><span class="p">],</span> <span class="n">base</span><span class="p">),</span>
                <span class="n">errors</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">]]</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    <span class="n">replace_price_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;Actual Sale Price / USD&#39;</span><span class="p">)</span>
    <span class="n">replace_price_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;Predicted Sale Price / USD&#39;</span><span class="p">)</span>
    <span class="n">xlim</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="n">new_lim</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">new_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">new_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">new_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">new_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">new_lim</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">new_lim</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">new_lim</span><span class="p">,</span> <span class="n">new_lim</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;Scoring function</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mapper</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">+</span><span class="n">error_text</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">str_vals</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.97</span><span class="p">,</span>
               <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
               <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Ridge Regression&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_219_0.png" src="../_images/linear-regression_ames-housing-data_219_0.png" />
</div>
</div>
</section>
</section>
<section id="LASSO-regression">
<h2>LASSO regression<a class="headerlink" href="#LASSO-regression" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[135]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LassoCV</span><span class="p">(</span><span class="n">n_alphas</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[136]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[136]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>#sk-container-id-6 {color: black;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: "";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-6" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LassoCV(max_iter=10000, n_alphas=1000)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox" checked><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">LassoCV</label><div class="sk-toggleable__content"><pre>LassoCV(max_iter=10000, n_alphas=1000)</pre></div></div></div></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[137]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;lasso&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
<span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[137]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
342.5806017461771
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[138]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MSE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MedAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MAPerE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;lasso&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_predictions</span>
<span class="n">errors</span><span class="p">[</span><span class="s1">&#39;lasso&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MAE</span><span class="o">=</span><span class="n">MAE</span><span class="p">,</span> <span class="n">MSE</span><span class="o">=</span><span class="n">MSE</span><span class="p">,</span> <span class="n">RMSE</span><span class="o">=</span><span class="n">RMSE</span><span class="p">,</span>
                    <span class="n">MedAE</span><span class="o">=</span><span class="n">MedAE</span><span class="p">,</span> <span class="n">r2</span><span class="o">=</span><span class="n">r2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="id2">
<h3>Plotting real vs. predicted values<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[139]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">gen_comp_plot</span><span class="p">(</span><span class="s1">&#39;Lasso regression&#39;</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span>
              <span class="n">avg_price</span><span class="p">,</span> <span class="n">errors</span><span class="p">[</span><span class="s1">&#39;lasso&#39;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_226_0.png" src="../_images/linear-regression_ames-housing-data_226_0.png" />
</div>
</div>
</section>
</section>
<section id="Elastic-Net">
<h2>Elastic Net<a class="headerlink" href="#Elastic-Net" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[140]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ElasticNetCV</span><span class="p">(</span><span class="n">l1_ratio</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">n_alphas</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[141]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[141]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>#sk-container-id-7 {color: black;}#sk-container-id-7 pre{padding: 0;}#sk-container-id-7 div.sk-toggleable {background-color: white;}#sk-container-id-7 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-7 label.sk-toggleable__label-arrow:before {content: "";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-7 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-7 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-7 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "";}#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-7 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-7 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-7 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-7 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-7 div.sk-item {position: relative;z-index: 1;}#sk-container-id-7 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-7 div.sk-item::before, #sk-container-id-7 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-7 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-7 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-7 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-7 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-7 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-7 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-7 div.sk-label-container {text-align: center;}#sk-container-id-7 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-7 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-7" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>ElasticNetCV(l1_ratio=array([0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ]),
             max_iter=100000, n_alphas=1000)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox" checked><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">ElasticNetCV</label><div class="sk-toggleable__content"><pre>ElasticNetCV(l1_ratio=array([0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ]),
             max_iter=100000, n_alphas=1000)</pre></div></div></div></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[142]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;elastic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
<span class="n">model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[142]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
342.5806017461771
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[143]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">l1_ratio_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[143]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[144]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_predictions</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="s1">&#39;elastic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MSE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">MedAE</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;elastic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_predictions</span>
<span class="n">errors</span><span class="p">[</span><span class="s1">&#39;elastic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">MAE</span><span class="o">=</span><span class="n">MAE</span><span class="p">,</span> <span class="n">MSE</span><span class="o">=</span><span class="n">MSE</span><span class="p">,</span> <span class="n">RMSE</span><span class="o">=</span><span class="n">RMSE</span><span class="p">,</span>
                    <span class="n">MedAE</span><span class="o">=</span><span class="n">MedAE</span><span class="p">,</span> <span class="n">r2</span><span class="o">=</span><span class="n">r2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="id3">
<h3>Plotting real vs. predicted values<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[145]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Elastic net / $\lambda=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">l1_ratio_</span><span class="p">)</span>
<span class="n">gen_comp_plot</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">test_preds</span><span class="p">[</span><span class="s1">&#39;elastic&#39;</span><span class="p">],</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span>
              <span class="n">avg_price</span><span class="p">,</span> <span class="n">errors</span><span class="p">[</span><span class="s1">&#39;elastic&#39;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_234_0.png" src="../_images/linear-regression_ames-housing-data_234_0.png" />
</div>
</div>
</section>
</section>
</section>
<section id="Conclusion">
<h1>Conclusion<a class="headerlink" href="#Conclusion" title="Link to this heading">#</a></h1>
<p>First lets put all of the models together with the plots of real vs. predicted in one large plot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[146]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">axs</span><span class="p">)</span>
<span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ols&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="s1">&#39;MAE&#39;</span><span class="p">],</span> <span class="s1">&#39;lasso&#39;</span><span class="p">,</span> <span class="s1">&#39;elastic&#39;</span><span class="p">]</span>
<span class="n">names</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ols</span><span class="o">=</span><span class="s1">&#39;Ordinary Least Squares&#39;</span><span class="p">,</span>
             <span class="n">ridge</span><span class="o">=</span><span class="s1">&#39;Ridge Regression&#39;</span><span class="p">,</span>
             <span class="n">lasso</span><span class="o">=</span><span class="s1">&#39;LASSO regression&#39;</span><span class="p">,</span>
             <span class="n">elastic</span><span class="o">=</span><span class="s1">&#39;Elastic Net&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">keys</span><span class="p">)):</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">test_preds</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">test_preds</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">names</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">errors</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">errors</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Elastic&#39;</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">+=</span> <span class="s1">&#39; / $\lambda=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;elastic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">l1_ratio_</span><span class="p">)</span>
    <span class="n">gen_comp_plot</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">avg_price</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">text_tmp</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">error_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/linear-regression_ames-housing-data_236_0.png" src="../_images/linear-regression_ames-housing-data_236_0.png" />
</div>
</div>
<p>So whats the final conclusion from all this. Well, it seems that the LASSO regression model actually gives the <em>best</em> predictions as it has the lowest error metrics and the best R squared value. This is further supported by the fact that the Elastic Net model prefers the LASSO regression model as it has a <span class="math notranslate nohighlight">\(\lambda\)</span> value of 1.0. Granted, all of the models actually seem to perform the same, and based on the results the use of any one of them in our test set should yield predictions with
the same level of confidence.</p>
<p>What is interesting in this model, however, is that in our testing data we have the two points that are priced above 500,000. With the fitting parameters that we have it is possible that any predictions made above 500,000 may not be very accurate as they are not being included in the training data set. This could show a possible lack of data in that price range and possibly a lower confidence in the predictions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script></section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ames-housing-gui.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">GUI representation of description file</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Studying-data">Studying data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Checking-for-any-missing-values-in-the-original-data-set">Checking for any missing values in the original data set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Making-sure-that-there-is-a-description-for-every-available-feature-column">Making sure that there is a description for every available feature column</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Data-Preprocessing">Data Preprocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Outliers">Outliers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Electrical">Electrical</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Masonry-Veneer">Masonry Veneer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Basement">Basement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Garage">Garage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Pool-quality,-Alley,-Fence,-Misc-Feature">Pool quality, Alley, Fence, Misc Feature</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Lot-Frontage">Lot Frontage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Save-the-final-data-set-after-processing">Save the final data set after processing</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Linear-Regression">Linear Regression</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Import-linear-regression-libraries">Import linear regression libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Data-manipulation">Data manipulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Make-a-train-test-split">Make a train test split</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Scale-the-data">Scale the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Ordinary-least-squares">Ordinary least squares</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Plotting-real-vs.-predicted-values">Plotting real vs. predicted values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Ridge-Regression">Ridge Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Mean-Absolute-Error">Mean Absolute Error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Mean-Squared-Error-or-Root-Mean-Squared-Error">Mean Squared Error or Root Mean Squared Error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#R-Squared-(coefficient-of-determination)">R Squared (coefficient of determination)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Median-Absolute-Error">Median Absolute Error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Mean-Absolute-Percentage-Error">Mean Absolute Percentage Error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Analyzing-error-metrics">Analyzing error metrics</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Plotting-error-metrics">Plotting error metrics</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Plotting real vs. predicted values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#LASSO-regression">LASSO regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Plotting real vs. predicted values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Elastic-Net">Elastic Net</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Plotting real vs. predicted values</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Conclusion">Conclusion</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Herbert D Ludowieg
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023, Herbert D Ludowieg.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>